(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1031:function(t,e,n){"use strict";var i=n(890);n.n(i).a},1032:function(t,e,n){(t.exports=n(4)(!1)).push([t.i,".dropdown-box[data-v-35e0877e]{width:100%;margin-top:-44px}\n",""])},1033:function(t,e,n){"use strict";var i=n(891);n.n(i).a},1034:function(t,e,n){(t.exports=n(4)(!1)).push([t.i,".full-width{width:100%}\n",""])},1035:function(t,e,n){"use strict";var i=n(892);n.n(i).a},1036:function(t,e,n){(t.exports=n(4)(!1)).push([t.i,".hint[data-v-32cd5a17]{font-size:10px;opacity:0.5;color:inherit;display:block}\n",""])},766:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("flex-column",[t.loading?[n("fluro-page-preloader",{attrs:{contain:""}})]:n("tabset",{attrs:{justified:!0,vertical:!0}},[n("tab",{attrs:{heading:"Query Details"}},[t._t("default",[n("flex-column-body",{staticStyle:{background:"#fafafa"}},[n("v-container",[n("constrain",{attrs:{sm:""}},[n("h3",{attrs:{margin:""}},[t._v("Query Details")]),t._v(" "),n("div",{staticClass:"grid-list-xl"},[n("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.options,field:t.fieldHash.title},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t._v(" "),n("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.options,field:t.fieldHash.firstLine},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),!t.model.query||t.model.filterType?n("fluro-panel",[n("fluro-panel-title",[t.model.disableDataTypeSelect||t.model._id?[n("h4",[t._v(t._s(t._f("definitionTitle")(t.model.filterType,!0))+" ")])]:[n("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.options,field:t.fieldHash.filterType},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]],2),t._v(" "),n("fluro-panel-body",[n("filter-condition-group",{attrs:{rows:t.rows,useSample:!0,mini:!0,type:t.model.filterType,debounce:t.filterDebounce},model:{value:t.model.filterConfiguration,callback:function(e){t.$set(t.model,"filterConfiguration",e)},expression:"model.filterConfiguration"}})],1)],1):t._e()],1)],1),t._v(" "),n("v-container",{staticClass:"border-top"},[n("constrain",[n("h3",{attrs:{margin:""}},[t._v("Columns")]),t._v(" "),n("column-customiser",{attrs:{sampleData:t.sample,config:t.config,loadingSample:t.loadingSample},model:{value:t.model.columns,callback:function(e){t.$set(t.model,"columns",e)},expression:"model.columns"}})],1)],1)],1)])],2)],1)],2)};i._withStripped=!0;n(13),n(12);var o=n(809),l=n(118),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("list-group",t._l(t.model,(function(e,i){return n("list-group-item",[n("v-container",{attrs:{fluid:"","grid-list-xl":""}},[n("v-layout",{attrs:{"align-start":"",row:"",wrap:""}},[n("v-flex",{staticClass:"full-width",attrs:{sm10:"",xs12:"","pa-1":""}},[n("v-layout",{attrs:{"align-start":"",row:"",wrap:""}},[n("v-flex",{attrs:{sm4:"",xs12:""}},[n("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.options,field:t.fieldHash.title},model:{value:t.model[i],callback:function(e){t.$set(t.model,i,e)},expression:"model[index]"}})],1),t._v(" "),n("v-flex",{attrs:{sm8:"",xs12:""}},[n("path-selector",{attrs:{options:t.columnKeyOptions,loading:t.loadingSample},on:{pathupdated:function(e){for(var n=arguments.length,o=Array(n);n--;)o[n]=arguments[n];return t.pathUpdated.apply(void 0,[i].concat(o))}},model:{value:t.model[i].key,callback:function(e){t.$set(t.model[i],"key",e)},expression:"model[index].key"}})],1)],1)],1),t._v(" "),n("v-flex",{staticClass:"full-width",attrs:{sm2:"",xs12:"","pa-1":""}},[n("fluro-confirm-button",{attrs:{content:"Remove"},on:{click:function(e){return t.remove(i)}},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.confirming;return[n("v-btn",{staticStyle:{transition:"all 0.1s",width:"100%"},attrs:{flat:"",block:"",color:i?"red":""}},[t._v(t._s(i?"Confirm?":"Remove"))])]}}],null,!0)})],1)],1)],1)],1)})),1),t._v(" "),n("fluro-panel",[n("fluro-panel-body",[n("form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.add()}}},[n("v-container",{attrs:{fluid:"","grid-list-xl":"","pa-1":""}},[n("v-layout",{attrs:{row:"",wrap:"","grid-list-xl":""}},[n("v-flex",{attrs:{sm10:"",xs12:""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{sm4:"",xs12:""}},[n("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.options,field:t.fieldHash.title},model:{value:t.proposed,callback:function(e){t.proposed=e},expression:"proposed"}})],1),t._v(" "),n("v-flex",{attrs:{sm8:"",xs12:""}},[n("path-selector",{attrs:{options:t.columnKeyOptions,loading:t.loadingSample},on:{pathupdated:t.proposedPathUpdated},model:{value:t.proposed.key,callback:function(e){t.$set(t.proposed,"key",e)},expression:"proposed.key"}})],1)],1)],1),t._v(" "),n("v-flex",{attrs:{sm2:"",xs12:""}},[n("v-btn",{attrs:{block:"",color:"primary",type:"submit",disabled:!t.proposed.key},on:{click:function(e){return t.add()}}},[t._v("Add")])],1)],1)],1)],1)])],1)],1)};r._withStripped=!0;n(32),n(41),n(35),n(27);var a=n(6),s=(n(16),n(344)),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-layout",{attrs:{row:""}},[n("v-flex",{attrs:{"pr-0":""}},[n("v-select",{staticStyle:{overflow:"hidden","white-space":"nowrap"},attrs:{items:t.options,label:"Key Value","item-value":"key","item-text":"title",loading:!!t.loading&&"primary"},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.item;return[n("span",{staticStyle:{overflow:"hidden","white-space":"nowrap"}},[t._v(t._s(i.title))])]}}]),model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),n("v-flex",{attrs:{shrink:"","px-0":""}},[n("v-btn",{staticStyle:{height:"44px"},attrs:{flat:"",block:""},on:{click:t.toggle}},[n("fluro-icon",{attrs:{icon:t.expanded?"chevron-down":"chevron-left"}})],1)],1)],1),t._v(" "),t.expanded?n("div",{staticClass:"dropdown-box py-0"},[n("v-text-field",{attrs:{"single-line":""},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1):t._e(),t._v(" "),n("div",{staticClass:"muted mb-0",style:t.expanded?"margin-top: -18px":"margin-top: -30px"},[t._v("\n    \t"+t._s(t.model)+"\n    ")])],1)};u._withStripped=!0;var d={props:{options:{type:Array,required:!0},loading:{type:Boolean,default:!1},value:{type:String,required:!0}},data:function(){return{model:this.value,expanded:!1}},watch:{model:function(t){return this.$emit("pathupdated",t)},value:function(t){this.model=t}},methods:{toggle:function(){this.expanded=!this.expanded}}},f=(n(1031),n(0)),c=Object(f.a)(d,u,[],!1,null,"35e0877e",null);c.options.__file="src/components/content/edit/components/PathSelector.vue";var p=c.exports,m={mixins:[o.a],props:{value:{type:Array,default:function(){return[]}},sampleData:{type:Array,default:function(){return[]}},config:{type:Object},loadingSample:{type:Boolean,default:!1}},created:function(){},components:{FluroConfirmButton:s.default,PathSelector:p},data:function(){return{model:this.value,proposed:{title:"",key:""}}},methods:{add:function(){var t=JSON.parse(JSON.stringify(this.proposed));this.model.push(t),this.$set(this,"proposed",{title:"",key:""})},proposedPathUpdated:function(t){this.proposed.key=t},pathUpdated:function(t,e){this.model[t].key=e},remove:function(t){this.model.splice(t,1)},extract:function(t){var e=this,n=this.flatten(t);return _.chain(n).map((function(n,i){var o=i.split(".").length;_.times(o-1,(function(){;"      "}));var l=_.get(t,i),r=(Object(a.a)(l),i+" - "+n);if(_.isArray(l)&&("array",r=i+" (multiple items)"),_.isString(l)){var s=e.$fluro.date.moment(l,e.$fluro.date.moment.ISO_8601,!0);s.isValid()&&(l=s.toDate())}return _.isDate(l)&&"date",{key:i,title:r}})).sortBy((function(t){return t.title})).value()},flatten:function(t){var e={},n=[],i=[];return function t(o,l){var r,s,u,d,f;if(null!=l)if(Object(a.a)(l),"object"!=Object(a.a)(l))e[o]=l;else{if((d=n.indexOf(l))>=0)return f=i[d]||"this",void(e[o]="[Circular ("+f+")]");if(n.push(l),i.push(o),Array.isArray(l)){for(s=l.length,t(o),s>10&&(s=10),r=0;r<s;r++)t(o+"["+r+"]",l[r]);return}for(o&&(o+="."),0==(s=(u=Object.keys(l)).length)&&t(o,null),r=0;r<s;r++)t(o+u[r],l[u[r]])}else{if(""===o)return;e[o]=null}}("",t),e}},computed:{fieldsOutput:function(){var t,e=[];return(t={title:"Column Title",minimum:0,maximum:1,type:"string"}).key="title",e.push(t),e},sampleQuery:function(){var t=this;return t.sampleData.length?_.chain(t.sampleData).reduce((function(e,n){var i=t.extract(n);return _.each(i,(function(t){var n=e[t.key];n||((n=e[t.key]=t).examples=[]),-1==n.examples.indexOf(t.value)&&n.examples.push(t.value)})),e}),{}).values().value():[]},columnKeyOptions:function(){if(!this.sampleQuery||!this.sampleQuery.length)return[];var t=JSON.parse(JSON.stringify(this.sampleQuery));return t.splice(0,0,{title:"Select a Data Source",key:""}),t}}},h=(n(1033),Object(f.a)(m,r,[],!1,null,null,null));h.options.__file="src/components/content/edit/components/ColumnCustomiser.vue";var v=h.exports,y=(n(25),n(21)),g={mixins:[o.a],components:{FilterConditionGroup:l.default,ColumnCustomiser:v},methods:{modelUpdated:function(){this.update(this.model)},reloadSample:function(){var t=this;if(t.model.filterType)return t.loadingSample=!0,t.$fluro.api.post("/content/".concat(t.model.filterType,"/filter"),{filter:t.model.filterConfiguration,startDate:t.model.filterStartDate,endDate:t.model.filterEndDate,search:t.model.filterSearch,allDefinitions:!0,sample:!0,limit:5}).then((function(e){t.sample=e.data,t.loadingSample=!1})).catch((function(e){t.sample=[],t.loadingSample=!1}));console.log("NO FILTER TYPE")}},created:function(){this.model.filterConfiguration||(this.model.filterConfiguration={}),this.reloadSample()},watch:{changeString:function(){this.reloadSample()}},asyncComputed:{typeOptions:{default:[],get:function(){var t=this;return t.model.query?new Promise((function(t,e){return e()})):new Promise((function(e,n){t.$fluro.types.terms().then((function(n){var i=_.chain(n).map((function(e,n){return{name:e.parentType?"".concat(t.$fluro.types.readable(e.parentType)," - ").concat(t.$fluro.types.readable(n)):"".concat(t.$fluro.types.readable(n)),value:n,parentType:e.parentType}})).orderBy("name").values().value();i.unshift({name:"Anything",key:"node",value:"node"}),e(i)})).catch((function(t){n(t)}))}))}}},computed:{rows:function(){return[]},showOutline:function(){return!1},fieldsOutput:function(){var t=[];function e(e,n){n.key=e,t.push(n)}return e("title",{title:"Title",minimum:1,maximum:1,type:"string",placeholder:"Eg. My Awesome List"}),e("firstLine",{title:"Description",minimum:0,maximum:1,type:"string",placeholder:"Eg. A list of my favorite people"}),e("filterType",{title:"Type",minimum:0,maximum:1,type:"string",directive:"select",description:"The type of item you want to return from this query",options:this.typeOptions}),t},changeString:function(){if(!this.model.query){var t=y.FilterService.getFilterChangeString(this.model.filterConfiguration);return console.log("Filter configuration changed",t),"".concat(t)}}},data:function(){return{sample:[],loadingSample:!1,filterDebounce:500}}},x=(n(1035),Object(f.a)(g,i,[],!1,null,"32cd5a17",null));x.options.__file="src/components/content/edit/panels/query.vue";e.default=x.exports},809:function(t,e,n){"use strict";var i=n(40);e.a={props:{config:{type:Object,required:!0},context:{type:String,default:"new"}},data:function(){return{loading:!1}},mounted:function(){this.$set(this.model,"_type",this.config.type.definitionName)},extends:i.default,components:{FluroContentForm:i.default,FluroContentFormField:function(){return Promise.resolve().then(n.bind(null,58))},FluroPrivacySelect:function(){return n.e(55).then(n.bind(null,810))}},computed:{type:function(){return this.config.type},typeName:function(){return this.type?this.type.definitionName:""},itemID:function(){return this.model._id},definition:function(){return this.config.definition},definedFields:function(){return this.definition&&this.definition.fields&&this.definition.fields.length?this.definition.fields:[]},readableContentType:function(){return this.$fluro.types.readable(this.config.definition?this.config.definition.definitionName:this.config.type.definitionName)},fullBody:function(){return this.definition&&this.definition.data&&this.definition.data.fullBody},hideBody:function(){return this.definition&&this.definition.data&&this.definition.data.hideBody},titleLabel:function(){return"Title"},bodyLabel:function(){return"Body"}},methods:{}}},890:function(t,e,n){var i=n(1032);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(5).default)("c2ccab62",i,!1,{})},891:function(t,e,n){var i=n(1034);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(5).default)("f064ffa4",i,!1,{})},892:function(t,e,n){var i=n(1036);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n(5).default)("04a8fe70",i,!1,{})}}]);