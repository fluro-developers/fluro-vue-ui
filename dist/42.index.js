(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{493:function(e,i,t){"use strict";t.r(i);var n=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("flex-column",[e.loadingAnything?[t("fluro-page-preloader",{attrs:{contain:""}})]:[t("tabset",{attrs:{justified:!0}},[t("tab",{attrs:{heading:"Basic Permissions"}},[t("tabset",{attrs:{justified:!0,vertical:!0,persist:!0},scopedSlots:e._u([{key:"menuprefix",fn:function(){return[t("div",{staticClass:"search-box"},[t("search-input",{attrs:{placeholder:"Search permissions"},model:{value:e.search,callback:function(i){e.search=i},expression:"search"}})],1)]},proxy:!0}])},[e._v(" "),e._l(e.filteredBasic,(function(i){return t("tab",{attrs:{heading:i.title+" "+e.of(i),muted:!e.enabled(i).length}},[t("v-container",[t("h4",{attrs:{margin:""}},[e._v(e._s(i.title))]),e._v(" "),t("list-group",e._l(i.permissions,(function(i){return t("fluro-toggle-item",{attrs:{inactive:!e.permissionSelected(i)},nativeOn:{click:function(t){return e.togglePermission(i)}}},[t("strong",[e._v(e._s(i.title))]),e._v(" "),t("div",{staticClass:"sm muted"},[e._v(e._s(i.description))])])})),1)],1)],1)}))],2)],1),e._v(" "),t("tab",{attrs:{heading:"Defined Permissions"}},[t("tabset",{attrs:{justified:!0,vertical:!0,persist:!0},scopedSlots:e._u([{key:"menuprefix",fn:function(){return[t("div",{staticClass:"search-box"},[t("search-input",{attrs:{placeholder:"Search permissions"},model:{value:e.search,callback:function(i){e.search=i},expression:"search"}})],1)]},proxy:!0}])},[e._v(" "),e._l(e.filteredDefined,(function(i){return t("tab",{attrs:{heading:i.title+" "+e.of(i),muted:!e.enabled(i).length}},[t("v-container",[t("h4",{attrs:{margin:""}},[e._v(e._s(i.title))]),e._v(" "),t("list-group",e._l(i.permissions,(function(i){return t("fluro-toggle-item",{attrs:{inactive:!e.permissionSelected(i)},nativeOn:{click:function(t){return e.togglePermission(i)}}},[t("strong",[e._v(e._s(i.title))]),e._v(" "),t("div",{staticClass:"sm muted"},[e._v(e._s(i.description))])])})),1)],1)],1)}))],2)],1),e._v(" "),t("tab",{attrs:{heading:e.informationPanelTitle}},[t("flex-column-body",{staticStyle:{background:"#fafafa"}},[t("v-container",{attrs:{fluid:""}},[t("constrain",{attrs:{sm:""}},[t("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.options,field:e.fieldHash.title},on:{input:e.update},model:{value:e.model,callback:function(i){e.model=i},expression:"model"}}),e._v(" "),t("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.options,field:e.fieldHash.firstLine},on:{input:e.update},model:{value:e.model,callback:function(i){e.model=i},expression:"model"}}),e._v(" "),e.definition&&e.definition.fields&&e.definition.fields.length?[t("h4",{attrs:{margin:""}},[e._v(e._s(e.definition.title)+" Information")]),e._v(" "),t("fluro-content-form",{attrs:{options:e.options,fields:e.definition.fields},model:{value:e.model.data,callback:function(i){e.$set(e.model,"data",i)},expression:"model.data"}})]:e._e()],2)],1)],1)],1)],1)]],2)};n._withStripped=!0;var s=t(512),o=t(49),r=t(171),a=(t(7),{components:{FluroToggleItem:r.a,SearchInput:o.a},created(){},data:()=>({search:"",loadingPermissions:!0}),mixins:[s.a],methods:{of(e){var i=e.permissions.length,t=this.enabled(e);return t.length?`${t.length} / ${i}`:""},enabled(e){var i=_.map(e.permissions,"value");return _.intersection(this.model.permissions,i)},togglePermission(e){if(this.model.permissions||this.$set(this.model,"permissions",[]),this.permissionSelected(e)){var i=this.model.permissions.indexOf(e.value);-1!=i&&this.model.permissions.splice(i,1)}else this.model.permissions.push(e.value)},permissionSelected(e){return _.includes(this.model.permissions,e.value)}},asyncComputed:{tree:{default:[],get(){var e=this;return e.loadingPermissions=!0,new Promise((function(i,t){return e.$fluro.access.retrievePermissions().then((function(t){_.each(t,(function(e){e.searchString=`${e.title} ${e.plural}`.toLowerCase(),e.permissionsString=_.map(e.permissions,(function(e){return e.searchString=(""+e.title).toLowerCase(),e.searchString})).join(" ")})),i(t),console.log("GOT EM!",t),e.loadingPermissions=!1})).catch((function(i){t(i),e.loadingPermissions=!1}))}))}}},computed:{informationPanelTitle(){return this.definition?this.definition.title+" Information":"Role Information"},filtered(){if(!this.search||!this.search.length)return console.log("No search words"),this.tree;var e=this.search.toLowerCase();return console.log("Filter by",e),_.chain(this.tree).map((function(i){if(i.searchString.includes(e))return i;if(i.permissionsString.includes(e)){var t=JSON.parse(JSON.stringify(i));if(t.permissions=_.filter(t.permissions,(function(i){return i.searchString.includes(e)})),t.permissions.length)return t}})).compact().value()},filteredBasic(){return _.filter(this.filtered,(function(e){return!e.parentType}))},filteredDefined(){return _.filter(this.filtered,(function(e){return e.parentType}))},loadingAnything(){return this.loading||this.loadingPermissions},fieldsOutput(){var e=[];function i(i,t){t.key=i,e.push(t)}return i("title",{title:"Title",minimum:1,maximum:1,type:"string"}),i("firstLine",{title:"Description",description:"Enter a one line description summarizing what this role is for and the permissions it grants",minimum:0,maximum:1,type:"string"}),e}}}),l=(t(741),t(0)),d=Object(l.a)(a,n,[],!1,null,"47bd2277",null);d.options.__file="src/components/content/edit/panels/role.vue";i.default=d.exports},512:function(e,i,t){"use strict";var n=t(10);i.a={props:{config:{type:Object,required:!0},context:{type:String,default:"new"}},data:()=>({loading:!1}),mounted(){this.$set(this.model,"_type",this.config.type.definitionName)},extends:n.default,components:{FluroContentForm:n.default,FluroContentFormField:()=>Promise.resolve().then(t.bind(null,11)),FluroPrivacySelect:()=>t.e(54).then(t.bind(null,513))},computed:{type(){return this.config.type},typeName(){return this.type?this.type.definitionName:""},itemID(){return this.model._id},definition(){return this.config.definition},definedFields(){return this.definition&&this.definition.fields&&this.definition.fields.length?this.definition.fields:[]},readableContentType(){return this.$fluro.types.readable(this.config.definition?this.config.definition.definitionName:this.config.type.definitionName)},fullBody(){return this.definition&&this.definition.data&&this.definition.data.fullBody},hideBody(){return this.definition&&this.definition.data&&this.definition.data.hideBody},titleLabel:()=>"Title",bodyLabel:()=>"Body"},methods:{}}},597:function(e,i,t){var n=t(742);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,t(3).default)("151a2c0f",n,!1,{})},741:function(e,i,t){"use strict";var n=t(597);t.n(n).a},742:function(e,i,t){(e.exports=t(2)(!1)).push([e.i,".search-box[data-v-47bd2277]{padding:10px}\n",""])}}]);