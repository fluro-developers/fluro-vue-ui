(window.webpackJsonp=window.webpackJsonp||[]).push([[14,67],{749:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("flex-column",[t.loading?[i("fluro-page-preloader",{attrs:{contain:""}})]:i("tabset",{attrs:{justified:!0,vertical:!0},scopedSlots:t._u([{key:"menuprefix",fn:function(){return["edit"==t.context&&t.$vuetify.breakpoint.mdAndUp?[i("flex-column-header",{staticStyle:{"text-align":"center"}},[i("div",{staticStyle:{padding:"10px","max-width":"200px",margin:"auto"}},[i("fluro-avatar-update",{attrs:{id:t.model._id,type:"contact"}})],1),t._v(" "),i("v-container",{staticClass:"border-bottom text-xs-center",attrs:{"px-0":"",fluid:""}},[i("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1 ml-0",attrs:{disabled:!t.canEmail,icon:"",color:"primary",content:"Send Email"},on:{click:function(e){return t.communicate("email")}}},[i("fluro-icon",{attrs:{library:"fas",icon:"envelope"}})],1),t._v(" "),i("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1",attrs:{disabled:!t.canSMS,icon:"",color:"primary",content:"Send SMS"},on:{click:function(e){return t.communicate("sms")}}},[i("fluro-icon",{attrs:{library:"fas",icon:"comment"}})],1),t._v(" "),i("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1",attrs:{disabled:!t.canCall,icon:"",color:"primary",content:"Call"},on:{click:function(e){return t.communicate("phone")}}},[i("fluro-icon",{attrs:{library:"fas",icon:"phone"}})],1),t._v(" "),i("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1",attrs:{disabled:!t.canPost,icon:"",color:"primary",content:"Add Post/Note"},on:{click:t.addPost}},[i("fluro-icon",{attrs:{library:"fas",type:"post"}})],1),t._v(" "),i("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1 mr-0",attrs:{icon:"",color:"primary",content:"Add to Address Book"},on:{click:function(e){return t.communicate("vcard")}}},[i("fluro-icon",{attrs:{library:"fas",icon:"address-book"}})],1)],1)],1)]:t._e()]},proxy:!0}])},[t._v(" "),i("tab",{attrs:{heading:"Basic Details"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",{staticClass:"grid-list-xl"},[i("constrain",{attrs:{sm:""}},[i("h3",{attrs:{margin:""}},[t._v("Basic Details")]),t._v(" "),t.$vuetify.breakpoint.xsOnly?["edit"==t.context?[i("div",{staticStyle:{"max-width":"200px",margin:"auto"}},[i("fluro-avatar-update",{attrs:{id:t.model._id,type:"contact"}})],1)]:t._e()]:t._e(),t._v(" "),i("wrapper",{attrs:{xs:""}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{class:{xs12:t.$vuetify.breakpoint.xsOnly}},[i("fluro-content-form-field",{staticClass:"right-messages",attrs:{autofocus:t.$vuetify.breakpoint.smAndUp,"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.firstName},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t._v(" "),t.showPreferredName?i("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.preferredName},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}):t._e(),t._v(" "),t.showEthnicName?i("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.ethnicName},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}):t._e(),t._v(" "),i("div",{staticClass:"additions"},[t.showPreferredName?t._e():i("a",{staticClass:"hint",on:{click:function(e){t.show.preferredName=!0}}},[t._v("Add Nick/Preferred Name")]),t._v(" "),t.showEthnicName?t._e():i("a",{staticClass:"hint",on:{click:function(e){t.show.ethnicName=!0}}},[t._v("Add Ethnic Name")])])],1),t._v(" "),t.showMiddleName?i("v-flex",{class:{xs12:t.$vuetify.breakpoint.xsOnly}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.middleName},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1):t._e(),t._v(" "),i("v-flex",{class:{xs12:t.$vuetify.breakpoint.xsOnly}},[i("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.lastName},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t._v(" "),t.showMaidenName?i("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.maidenName},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}):t._e(),t._v(" "),i("div",{staticClass:"additions"},[t.showMiddleName?t._e():i("a",{staticClass:"hint",on:{click:function(e){t.show.middleName=!0}}},[t._v("Add Middle Name")]),t._v(" "),t.showMaidenName?t._e():i("a",{staticClass:"hint",on:{click:function(e){t.show.maidenName=!0}}},[t._v("Add Maiden Name")])])],1)],1),t._v(" "),t.contactDefinitions.length?[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.definitionField},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]:t._e()],2),t._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.gender},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.maritalStatus},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1),t._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,options:t.formOptions,field:t.fieldHash.emails},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,options:t.formOptions,field:t.fieldHash.phoneNumbers},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1),t._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm6:""}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.dob},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),i("v-flex",{attrs:{xs6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.dobVerified},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.timezone},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1),t._v(" "),i("wrapper",{attrs:{xs:""}},[i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v("School / Academic Details")]),t._v(" "),i("fluro-academic-select",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions},on:{calendar:t.updateAcademicCalendar,grade:t.updateAcademicGrade},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v("Checkin Nametag Notes")]),t._v(" "),i("p",{staticClass:"help-block"},[t._v("Publicly displayed notes to be printed on "+t._s(t.contextName)+" nametag")]),t._v(" "),i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,showLabel:!1,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.nametagNotes},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],2)],1)],1)])],2),t._v(" "),t.itemID?i("tab",{attrs:{heading:"Activity Timeline"}},[i("tabset",{attrs:{justified:!0}},[i("tab",{attrs:{heading:"Timeline"}},[i("contact-timeline",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],1):t._e(),t._v(" "),i("tab",{attrs:{heading:"Household & Relationships"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",{attrs:{"grid-list-xl":""}},[i("constrain",{attrs:{sm:""}},["edit"==t.context?[i("h3",{attrs:{margin:""}},[t._v("Household / Residence")]),t._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"override-label":t.contextName+" Household Role","form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.householdRole},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1),t._v(" "),i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v("Family Household")]),t._v(" "),i("p",{staticClass:"help-block"},[t._v("Select "+t._s(t.contextName)+" primary residence")]),t._v(" "),i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,showLabel:!1,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.family},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)]:[i("h3",{attrs:{margin:""}},[t._v("Household")]),t._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"override-label":t.contextName+" Household Role","form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.householdRole},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1),t._v(" "),t.model._id?[i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v("Family Household")]),t._v(" "),i("p",{staticClass:"help-block"},[t._v("Select "+t._s(t.contextName)+" primary residence")]),t._v(" "),i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,showLabel:!1,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.family},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)]:i("fluro-panel",[i("tabset",[i("tab",{attrs:{heading:"Create new Household"}},[i("v-container",[i("fluro-content-form",{attrs:{options:t.formOptions,fields:t.familyFields},on:{input:t.updateFamily},model:{value:t.family,callback:function(e){t.family=e},expression:"family"}})],1)],1),t._v(" "),i("tab",{attrs:{heading:"Add to existing Household"}},[i("v-container",[i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v("Family Household")]),t._v(" "),i("p",{staticClass:"help-block"},[t._v("Select "+t._s(t.contextName)+" primary residence")]),t._v(" "),i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,showLabel:!1,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.family},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],1)],1)],1)],t._v(" "),i("h3",{attrs:{margin:""}},[t._v("Relationships")]),t._v(" "),i("contact-relationship-manager",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],2)],1)],1)])],2),t._v(" "),t.model._id?i("tab",{attrs:{heading:"Groups & Teams"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",[i("constrain",{attrs:{sm:""}},[i("h3",{attrs:{margin:""}},[t._v(t._s(t.contextName)+" Groups & Teams")]),t._v(" "),i("contact-group-manager",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],1)])],2):t._e(),t._v(" "),t.model._id?i("tab",{attrs:{heading:"Processes"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",[i("constrain",{attrs:{sm:""}},[i("h3",{attrs:{margin:""}},[t._v(t._s(t.contextName)+" Progress")]),t._v(" "),i("contact-process-manager",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1)],1)])],2):t._e(),t._v(" "),i("tab",{attrs:{heading:"Capabilities"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",{attrs:{"grid-list-xl":""}},[i("constrain",{attrs:{sm:""}},[i("h3",{attrs:{margin:""}},[t._v(t._s(t.contextName)+" Capabilities")]),t._v(" "),i("contact-capability-manager",{model:{value:t.model.capabilities,callback:function(e){t.$set(t.model,"capabilities",e)},expression:"model.capabilities"}})],1)],1)],1)])],2),t._v(" "),"edit"==t.context?i("tab",{attrs:{heading:"Rostering / Availability"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",{attrs:{"grid-list-xl":""}},[i("constrain",{attrs:{sm:""}},[t.model._id?i("div",[i("h3",{attrs:{margin:""}},[t._v(t._s(t.contextName)+" Unavailability")]),t._v(" "),i("contact-unavailability-manager",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1):t._e()])],1)],1)])],2):t._e(),t._v(" "),"edit"==t.context?i("tab",{attrs:{heading:"Notifications"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",{attrs:{"grid-list-xl":""}},[i("constrain",{attrs:{sm:""}},[i("h3",{attrs:{margin:""}},[t._v("Notifications")]),t._v(" "),i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.countryCode},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t._v(" "),t.phoneNumbers.length||t.emails.length?i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v("Communication Preferences")]),t._v(" "),i("p",{staticClass:"help-block"},[t._v("Manage "+t._s(t.contextName)+" subscription preferences below")]),t._v(" "),i("div",{staticClass:"toggle-items"},[t.emails.length?[i("fluro-toggle-item",{attrs:{inactive:t.unsubscribedMailout},nativeOn:{click:function(e){return t.toggleSubscription("mailout")}}},[t._v("\n                                            Allow Promotional Emails\n                                        ")])]:t._e(),t._v(" "),t.phoneNumbers.length?[i("fluro-toggle-item",{attrs:{inactive:t.unsubscribedSMS},nativeOn:{click:function(e){return t.toggleSubscription("sms")}}},[t._v("\n                                            Allow Promotional SMS\n                                        ")])]:t._e()],2)],1):t._e(),t._v(" "),i("p"),t._v(" "),t.devices.length?i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v(t._s(t.contextName)+" Connected Devices")]),t._v(" "),i("list-group",t._l(t.devices,(function(e){return i("list-group-item",{scopedSlots:t._u([{key:"left",fn:function(){return[i("fluro-icon",{attrs:{icon:"mobile"}})]},proxy:!0},{key:"default",fn:function(){return[i("div",[i("strong",{staticClass:"text-capitalize"},[t._v("\n                                                    "+t._s(e.application)+" - "+t._s(e.metadata.model)+"\n                                                ")]),t._v(" "),i("div",{staticClass:"sm text-muted"},[t._v(t._s(e.metadata.platform)+" "+t._s(e.metadata.version))])])]},proxy:!0},{key:"right",fn:function(){return[i("v-btn",{attrs:{small:"",loading:e.pinging},on:{click:function(i){return t.ping(e)}}},[t._v("\n                                                Ping\n                                            ")])]},proxy:!0}],null,!0)})})),1),t._v(" "),i("p",{staticClass:"help-block"},[t._v("\n                                    If you are experiencing problems with push notifications it can sometimes be helpful to reset all devices for a contact allowing them to reconnect next time they sign in to an application\n                                ")]),t._v(" "),i("v-btn",{attrs:{small:""},on:{click:function(e){return t.resetDevices()}}},[i("span",[t._v("Reset all devices")]),t._v(" "),i("fluro-icon",{attrs:{icon:"trash"}})],1)],1):t._e()],1)],1)],1)])],2):t._e(),t._v(" "),t._l(t.sheetDefinitions,(function(e){return i("tab",{key:e._id,attrs:{heading:e.title}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",[i("constrain",{attrs:{sm:""}},[i("h3",{attrs:{margin:""}},[t._v(t._s(e.title))]),t._v(" "),i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v("Realms")]),t._v(" "),i("p",{staticClass:"help-block"},[t._v("Select where "+t._s(t.contextName)+" "+t._s(e.title)+" information should be stored")]),t._v(" "),i("fluro-realm-select",{attrs:{type:"contactdetail",definition:e.definitionName},on:{input:function(i){return t.updateSheetRealms(i,e.definitionName)}},model:{value:e.dataModel.realms,callback:function(i){t.$set(e.dataModel,"realms",i)},expression:"sheet.dataModel.realms"}})],1),t._v(" "),i("fluro-content-form",{attrs:{options:t.formOptions,fields:e.fields},on:{input:function(i){return t.updateSheet(i,e.definitionName)}},model:{value:e.dataModel.data,callback:function(i){t.$set(e.dataModel,"data",i)},expression:"sheet.dataModel.data"}})],1)],1)],1)])],2)})),t._v(" "),"edit"==t.context?i("tab",{attrs:{heading:"Metadata"}},[t._t("default",[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",[i("constrain",{attrs:{sm:""}},[i("h3",{attrs:{margin:""}},[t._v("Metadata")]),t._v(" "),i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.timezone},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t._v(" "),i("v-layout",[i("v-flex",[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.deceased},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),i("v-flex",{directives:[{name:"show",rawName:"v-show",value:t.model.deceased,expression:"model.deceased"}]},[i("fluro-content-form-field",{attrs:{"form-fields":t.formFields,outline:t.showOutline,options:t.formOptions,field:t.fieldHash.deceasedDate},on:{input:t.update},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1)],1),t._v(" "),t.model.data?i("div",[i("v-card",[i("v-card-text",[i("h5",[t._v("Explore Metadata")]),t._v(" "),i("json-view",{attrs:{deep:3,data:t.model.data}})],1)],1)],1):t._e()],1)],1)],1)])],2):t._e()],2)],2)};a._withStripped=!0;i(293),i(21),i(13),i(32),i(11);var o=i(344),n=i(74),s=i(798),r=i(340),l=i(343),c=i(347),d=i(909),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("fluro-page-preloader",{attrs:{contain:""}}):[t.sorted.length?t._l(t.sorted,(function(e){return i("contact-process-state",{attrs:{card:e},nativeOn:{click:function(i){return t.clicked(e)}}})})):[i("em",[t._v("No process information is available")])]]],2)};u._withStripped=!0;var m=i(146),f=i(147),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"process-state-card",class:t.card.processStatus},[i("fluro-card",[i("div",{staticClass:"color-block"}),t._v(" "),i("fluro-card-body",[t.card.dueDate?i("div",{staticClass:"due-date"},[i("fluro-icon",{attrs:{icon:"clock"}}),t._v(" "+t._s(t.dueText))],1):t._e(),t._v(" "),i("h5",[t._v(t._s(t.card.title))]),t._v(" "),i("div",[i("strong",[t._v(t._s(t.currentState.title))]),t._v(" "),"linear"==t.mode?[t._v(" - "+t._s(t.percent))]:t._e()],2),t._v(" "),i("div",[t._v(t._s(t.taskSummary))]),t._v(" "),i("div",{staticClass:"process-dots"},t._l(t.renderStates,(function(t){return i("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"process-dot",class:t.result,attrs:{content:t.title}},[i("fluro-icon",{attrs:{library:t.iconLibrary,icon:t.icon}})],1)})),0)])],1)],1)};p._withStripped=!0;i(48),i(86);var v={props:{card:{type:Object,required:!0}},computed:{taskSummary:function(){return this.formsPending?"Awaiting ".concat(this.formsPending," form response").concat(1==this.formsPending?"":"s"):this.tasksIncomplete?"".concat(this.tasksIncomplete," task").concat(1==this.tasksIncomplete?"":"s"):void 0},tasksIncomplete:function(){return parseInt(this.card.taskCount.incomplete)},formsPending:function(){return parseInt(this.card.taskCount.formsRequested)-parseInt(this.card.taskCount.formsCompleted)},processStatus:function(){return this.card.processStatus},dueDate:function(){return this.card.dueDate},dueText:function(){if(this.dueDate)switch(this.processStatus){case"complete":return"Will progress ".concat(this.$fluro.date.timeago(this.card.dueDate));default:return"Due ".concat(this.$fluro.date.timeago(this.card.dueDate))}},renderStates:function(){var t=this;return _.chain(t.states).filter((function(t){return"waiting"!=t.style})).map((function(e){if(e.iconLibrary="fas",e.key==t.state)return e.iconLibrary="far",e.icon="dot-circle",e;switch(e.result){case"failed":e.icon="exclamation-circle";break;case"complete":e.icon="check-circle";break;default:e.icon="circle",e.iconLibrary="far"}return e})).value()},currentStep:function(){return _.findIndex(this.states,{key:this.state})},totalSteps:function(){return this.states.length},percent:function(){return Math.ceil(this.currentStep/this.totalSteps*100)+"%"},currentIndex:function(){return _.findIndex(this.states,{key:this.state})},state:function(){return this.card.state},states:function(){return this.card.states},mode:function(){return this.card.mode},stateLookup:function(){return _.reduce(this.card.states,(function(t,e){return t[e.key]=e,t}),{})},currentState:function(){var t=_.find(this.states,{key:this.state});return t||{title:"Stuck / Limbo",key:"_limbo"}}}},h=(i(956),i(0)),b=Object(h.a)(v,p,[],!1,null,null,null);b.options.__file="src/components/content/edit/components/ContactProcessState.vue";var g=b.exports,y=i(25),x=i.n(y),k={props:{value:{type:Object,required:!0}},data:function(){return{actionIndexes:{},model:this.value,loading:!0,cards:[]}},created:function(){this.reloadCards()},methods:{clicked:function(t){var e=this;return e.$fluro.global.edit(t,!0).then((function(t){console.log("Result!",t),e.reloadCards()})).catch((function(t){console.log("Cancelled!",t)}))},reloadCards:function(){var t=this;return t.loading=!0,t.$fluro.api.get("/process/states/".concat(t.contactID)).then((function(e){t.cards=e.data,t.loading=!1})).catch((function(e){t.cards=e,t.loading=!1}))}},components:{ListGroup:m.a,ListGroupItem:f.a,ContactProcessState:g},computed:{sorted:function(){return _.orderBy(this.cards,this.$fluro.utils.processCardPrioritySort)},contactID:function(){return this.$fluro.utils.getStringID(this.model)}}},N=Object(h.a)(k,u,[],!1,null,null,null);N.options.__file="src/components/content/edit/components/ContactProcessManager.vue";var D=N.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("fluro-page-preloader",{attrs:{contain:""}}):t._l(t.capabilityGroups,(function(e){return i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v(t._s(e.title))]),t._v(" "),i("list-group",[t._l(e.capabilities,(function(e){return[i("list-group-item",{attrs:{item:e},scopedSlots:t._u([{key:"right",fn:function(){return[i("v-btn",{staticClass:"ma-0",attrs:{small:"",icon:""},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.remove(e)}}},[i("fluro-icon",{attrs:{icon:"times"}})],1)]},proxy:!0}],null,!0)})]}))],2),t._v(" "),i("v-btn",{staticClass:"ml-0",attrs:{small:"",color:"primary"},on:{click:function(i){return t.select(e.key)}}},[t._v("\n                Add "+t._s(e.title)+"\n                "),i("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)],1)}))],2)};w._withStripped=!0;i(51),i(28);var C=i(99),S=i(148),$={props:{value:{type:Array,required:!0}},data:function(){return{loading:!0,actionIndexes:{},model:this.value}},created:function(){},methods:{remove:function(t){var e=this.model.indexOf(t);this.model.splice(e,1)},addItem:function(t){_.some(this.model,{_id:t._id})||this.model.push(t)},select:function(t){var e=this,i=new(x.a.extend(S.a))({propsData:{minimum:0,maximum:0}});e.$fluro.modal({component:C.a,options:{allDefinitions:!1,selector:i,type:t,minimum:0,maximum:0}}).then((function(t){t&&t.length&&(console.log("Items"),_.each(t,(function(t){e.addItem(t)})))}))}},components:{ListGroup:m.a,ListGroupItem:f.a,FluroContentSelectModal:C.a},computed:{capabilityGroups:function(){var t=this,e=_.reduce(t.capabilityDefinitions,(function(t,e){return t[e.definitionName]={title:e.plural,capabilities:[],key:e.definitionName},t}),{capability:{title:"Capabilities",capabilities:[],key:"capability"}});return _.chain(t.model).reduce((function(e,i){var a=i.definition||"capability",o=e[a];return o||(o=e[a]={title:t.$fluro.types.readable(a,!0),capabilities:[]}),o.capabilities.push(i),e}),e).values().value()}},asyncComputed:{capabilityDefinitions:{default:[],get:function(){var t=this;return t.loading=!0,new Promise((function(e,i){t.$fluro.types.subTypes("capability").then((function(i){e(i),t.loading=!1})).catch((function(e){i(e),t.loading=!1}))}))}}}},M=Object(h.a)($,w,[],!1,null,null,null);M.options.__file="src/components/content/edit/components/ContactCapabilityManager.vue";var O=M.exports,I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("fluro-page-preloader",{attrs:{contain:""}}):[i("v-layout",{attrs:{row:"",wrap:""}},[t._l(t.backlinks,(function(e){return[i("v-flex",[i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v(t._s(t._f("capitalize")(e.relationship))+" "),i("span",{staticClass:"anniversary"},[t._v(t._s(t.anniversaryDate(e)))])]),t._v(" "),i("div",{staticClass:"relation-faces"},t._l(e.contacts,(function(e){return i("div",{staticClass:"relation-face",class:e.status,on:{click:function(i){return t.$fluro.global.edit(e,!0)}}},[i("fluro-avatar",{attrs:{lg:"",id:e}}),t._v(" "),i("div",{staticClass:"details"},[i("div",[i("strong",[t._v(t._s(e.title))])]),t._v(" "),i("div",[t._v(t._s(e.householdRole))]),t._v(" "),i("div",[t._v(t._s(e.gender))]),t._v(" "),i("div",[t._v(t._s(e.age))]),t._v(" "),i("div",[t._v(t._s(t._f("definitionTitle")(e.definition)))]),t._v(" "),i("fluro-status-label",{attrs:{value:e.status}})],1)],1)})),0)],1)],1)]})),t._v(" "),t._l(t.model.relationships,(function(e){return[i("v-flex",[i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v(t._s(t.contextName)+" "+t._s(t._f("capitalize")(e.relationship))+" "),i("span",{staticClass:"anniversary"},[t._v(t._s(t.anniversaryDate(e)))])]),t._v(" "),i("div",{staticClass:"relation-faces"},t._l(e.contacts,(function(e){return i("div",{staticClass:"relation-face",class:e.status,on:{click:function(i){return t.$fluro.global.edit(e,!0)}}},[i("fluro-avatar",{attrs:{lg:"",id:e}}),t._v(" "),i("div",{staticClass:"details"},[i("div",[i("strong",[t._v(t._s(e.title))])]),t._v(" "),i("div",[t._v(t._s(e.householdRole))]),t._v(" "),i("div",[t._v(t._s(e.gender))]),t._v(" "),i("div",[t._v(t._s(e.age))]),t._v(" "),i("div",[t._v(t._s(t._f("definitionTitle")(e.definition)))]),t._v(" "),i("fluro-status-label",{attrs:{value:e.status}})],1)],1)})),0)],1)],1)]}))],2),t._v(" "),i("fluro-panel",[i("fluro-panel-title",[i("h4",[t._v("Add a relationship")])]),t._v(" "),i("fluro-panel-body",[i("form",[i("v-layout",[i("v-flex",{attrs:{xs12:"",sm5:""}},[i("v-select",{attrs:{label:"Relationship","item-text":"title",items:t.relationshipTypes},model:{value:t.proposed.relationshipType,callback:function(e){t.$set(t.proposed,"relationshipType",e)},expression:"proposed.relationshipType"}}),t._v(" "),t.customRelationship?[i("v-text-field",{attrs:{label:"Custom Relationshp",placeholder:"Boss, Coworker, Friend"},model:{value:t.proposed.relationship,callback:function(e){t.$set(t.proposed,"relationship",e)},expression:"proposed.relationship"}})]:t._e(),t._v(" "),"spouse"==t.proposed.relationship?[i("fluro-content-form-field",{attrs:{field:t.anniversaryField},model:{value:t.proposed,callback:function(e){t.proposed=e},expression:"proposed"}})]:t._e()],2),t._v(" "),i("v-flex",{attrs:{xs12:"",sm5:""}},[i("fluro-content-select-button",{attrs:{block:"",type:"contact"},model:{value:t.proposed.contacts,callback:function(e){t.$set(t.proposed,"contacts",e)},expression:"proposed.contacts"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm4:""}},[i("v-btn",{attrs:{block:"",color:"primary",disabled:t.disabled},on:{click:function(e){return t.add()}}},[t._v("\n                                Add\n                                "),i("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)],1)],1)],1)])],1)]],2)};I._withStripped=!0;var F=i(67),A=i(47),P={props:{value:{type:Object,required:!0}},data:function(){return{anniversaryField:{key:"anniversary",type:"date",title:"Anniversary Date"},actionIndexes:{},model:this.value,loading:!0,backlinks:[],proposed:{checkinAuthorised:!0,relationshipType:null,relationship:null,anniversary:null,contacts:[]}}},created:function(){console.log("RELOAD TEAMS"),this.reloadRelationships(),this.resetProposed()},methods:{anniversaryDate:function(t){if(t.anniversary)return"".concat(this.$fluro.date.formatDate(t.anniversary,"D MMM")," (").concat(this.$fluro.date.timeago(t.anniversary),")")},add:function(){var t=this.proposed;this.model.relationships&&this.model.relationships.length||this.$set(this.model,"relationships",[]),this.model.relationships.push(t),this.resetProposed()},resetProposed:function(){this.proposed={checkinAuthorised:!0,relationshipType:null,relationship:null,anniversary:null,contacts:[]}},reloadRelationships:function(){var t=this;t.loading=!0,t.contactID?t.$fluro.api.get("/contact/".concat(t.contactID,"/relationships"),{params:{backlinks:!0}}).then((function(e){t.backlinks=e.data,t.loading=!1})).catch((function(e){t.loading=!1})):t.loading=!1}},components:{FluroContentFormField:A.default,FluroContentSelectButton:F.default,ListGroup:m.a,ListGroupItem:f.a},watch:{"proposed.relationshipType":function(t){this.customRelationship||(this.proposed.relationship=t)}},computed:{relationships:function(){return this.backlinks},customRelationship:function(){return"other"==this.proposed.relationshipType},disabled:function(){return!(this.proposed.contacts&&this.proposed.contacts.length&&this.proposed.relationship&&this.proposed.relationship.length)||(!(!this.customRelationship||this.proposed.relationship&&this.proposed.relationship.length)||void 0)},contextName:function(){var t=this.model.preferredName||this.model.firstName||"";return t&&t.length?_.endsWith(t,"s")?"".concat(t,"'"):"".concat(t,"'s"):""},relationshipTypes:function(){var t=this.contextName;return[{title:"".concat(t," Parents"),value:"parents"},{title:"".concat(t," Guardians"),value:"guardians"},{title:"".concat(t," Children"),value:"children"},{title:"".concat(t," Siblings"),value:"siblings"},{title:"".concat(t," Spouse"),value:"spouse"},{title:"".concat(t," Partner"),value:"partner"},{title:"".concat(t," Grandparents"),value:"grandparents"},{title:"".concat(t," Grandchildren"),value:"grandchildren"},{title:"".concat(t," Aunt/Uncle"),value:"auntuncle"},{title:"".concat(t," Niece/Nephew"),value:"niecenephew"},{title:"Other",value:"other"}]},contactID:function(){if(this.model._id)return this.$fluro.utils.getStringID(this.model)}},filters:{capitalize:function(t){return _.startCase(t)}}},E=(i(958),Object(h.a)(P,I,[],!1,null,null,null));E.options.__file="src/components/content/edit/components/ContactRelationshipManager.vue";var R=E.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("fluro-page-preloader",{attrs:{contain:""}}):[i("list-group",[i("transition-group",t._l(t.unavailabilities,(function(e,a){return i("list-group-item",{key:JSON.stringify(e),staticClass:"ma-0 pa-0"},[i("v-layout",{attrs:{wrap:"","align-center":"","ma-0":""}},[i("v-flex",{attrs:{sm10:"",xs12:"","px-4":""}},[i("strong",[t._v(t._s(e.description))]),t._v(" "),i("p",{staticClass:"muted mb-0"},[t._v(t._s(t._f("readableDate")(e)))])]),t._v(" "),i("v-flex",{attrs:{sm2:"",xs12:""}},[i("fluro-confirm-button",{attrs:{content:"Remove"},on:{click:function(e){return t.remove(a)}},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.confirming;return[i("v-btn",{staticStyle:{transition:"all 0.1s",width:"100%"},attrs:{flat:"",block:"",color:a?"red":""}},[t._v(t._s(a?"Confirm?":"Remove"))])]}}],null,!0)})],1)],1)],1)})),1)],1),t._v(" "),i("fluro-panel",[i("fluro-panel-title",[i("h4",[t._v("Add an Unavailability Period")])]),t._v(" "),i("fluro-panel-body",[i("form",[i("v-layout",{attrs:{wrap:"","px-4":""}},[i("v-flex",{attrs:{xs12:"",sm12:""}},[i("fluro-content-form-field",{attrs:{field:t.description},model:{value:t.proposed,callback:function(e){t.proposed=e},expression:"proposed"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm5:""}},[i("v-dialog",{ref:"dialogStart",attrs:{"return-value":t.proposed.startDate,lazy:"","full-width":"",width:"290px"},on:{"update:returnValue":function(e){return t.$set(t.proposed,"startDate",e)},"update:return-value":function(e){return t.$set(t.proposed,"startDate",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[i("v-text-field",t._g({attrs:{label:"Start Date","prepend-icon":"event",readonly:""},model:{value:t.proposed.startDate,callback:function(e){t.$set(t.proposed,"startDate",e)},expression:"proposed.startDate"}},a))]}}]),model:{value:t.modalStart,callback:function(e){t.modalStart=e},expression:"modalStart"}},[t._v(" "),i("v-date-picker",{attrs:{min:t.startDateMin,scrollable:""},model:{value:t.proposed.startDate,callback:function(e){t.$set(t.proposed,"startDate",e)},expression:"proposed.startDate"}},[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.modalStart=!1}}},[t._v("Cancel")]),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){return t.$refs.dialogStart.save(t.proposed.startDate)}}},[t._v("OK")])],1)],1)],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm5:""}},[i("v-dialog",{ref:"dialogEnd",attrs:{"return-value":t.proposed.endDate,lazy:"","full-width":"",width:"290px"},on:{"update:returnValue":function(e){return t.$set(t.proposed,"endDate",e)},"update:return-value":function(e){return t.$set(t.proposed,"endDate",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[i("v-text-field",t._g({attrs:{label:"End Date","prepend-icon":"event",readonly:""},model:{value:t.proposed.endDate,callback:function(e){t.$set(t.proposed,"endDate",e)},expression:"proposed.endDate"}},a))]}}]),model:{value:t.modalEnd,callback:function(e){t.modalEnd=e},expression:"modalEnd"}},[t._v(" "),i("v-date-picker",{attrs:{min:t.endDateMin,scrollable:""},model:{value:t.proposed.endDate,callback:function(e){t.$set(t.proposed,"endDate",e)},expression:"proposed.endDate"}},[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.modalEnd=!1}}},[t._v("Cancel")]),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){return t.$refs.dialogEnd.save(t.proposed.endDate)}}},[t._v("OK")])],1)],1)],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm2:""}},[i("v-btn",{attrs:{block:"",color:"primary",disabled:!1},on:{click:function(e){return t.add()}}},[t._v("\n                                Add\n                                "),i("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)],1)],1)],1)])],1)]],2)};T._withStripped=!0;i(19),i(20);var H=i(338),L={props:{value:{type:Object,required:!0}},data:function(){return{description:{key:"description",type:"string",minimum:1,maximum:1,placeholder:"Away on holidays",title:"Description"},actionIndexes:{},loading:!0,modalStart:!1,modalEnd:!1,model:this.value,unavailabilities:[],proposed:{description:void 0,startDate:this.startDateMin,endDate:this.startDateMin}}},created:function(){console.log("RELOAD TEAMS"),this.reloadRelationships(),this.resetProposed()},methods:{add:function(){var t=this,e=JSON.parse(JSON.stringify(t.proposed));return e.startDate=new Date(e.startDate),e.startDate.setHours(0),e.startDate.setMinutes(0),e.startDate.setSeconds(0),e.endDate=new Date(e.endDate),e.endDate.setHours(23),e.endDate.setMinutes(59),e.endDate.setSeconds(59),t.$fluro.api.post("/contact/".concat(t.contactID,"/unavailability"),e).then((function(e){t.$fluro.notify("Successfully updated ".concat(t.contextName," unavailability"),{type:"success"}),t.unavailabilities.push(e.data),t.resetProposed()})).catch((function(e){t.$fluro.error(e)}))},resetProposed:function(){this.proposed={description:void 0,startDate:this.startDateMin,endDate:this.startDateMin}},reloadRelationships:function(){var t=this;t.loading=!0,t.contactID?t.$fluro.api.get("/contact/".concat(t.contactID,"/unavailability"),{}).then((function(e){t.unavailabilities=e.data,t.loading=!1})).catch((function(e){t.loading=!1})):t.loading=!1},remove:function(t){var e=this;return e.$fluro.api.delete("/contact/".concat(e.contactID,"/unavailability/").concat(e.unavailabilities[t]._id)).then((function(i){e.$fluro.notify("Successfully deleted ".concat(e.contextName," unavailability '").concat(e.unavailabilities[t].description,"'"),{type:"success"}),e.unavailabilities.splice(t,1)})).catch((function(t){e.$fluro.error(t)}))}},components:{FluroContentFormField:A.default,FluroContentSelectButton:F.default,ListGroup:m.a,ListGroupItem:f.a,FluroConfirmButton:H.default},watch:{"proposed.startDate":function(){this.proposed.endDate<this.proposed.startDate&&(this.proposed.endDate=this.proposed.startDate)}},computed:{contextName:function(){var t=this.model.preferredName||this.model.firstName||"";return t&&t.length?_.endsWith(t,"s")?"".concat(t,"'"):"".concat(t,"'s"):""},contactID:function(){if(this.model._id)return this.$fluro.utils.getStringID(this.model)},contactTitle:function(){return _.get(this.model,"title")||""},startDateMin:function(){var t=new Date;function e(t){var e=t.toString();return 1==e.length?"0"+e:e}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())},endDateMin:function(){var t=new Date(_.get(this.proposed,"startDate"));function e(t){var e=t.toString();return 1==e.length?"0"+e:e}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())}},filters:{capitalize:function(t){return _.startCase(t)},readableDate:function(t){return this.$fluro.date.moment(t.startDate).format("dddd, MMMM Do YYYY")==this.$fluro.date.moment(t.endDate).format("dddd, MMMM Do YYYY")?this.$fluro.date.moment(t.startDate).format("dddd, MMMM Do YYYY"):this.$fluro.date.moment(t.startDate).format("dddd, MMMM Do YYYY")+" - "+this.$fluro.date.moment(t.endDate).format("dddd, MMMM Do YYYY")}}},G=Object(h.a)(L,T,[],!1,null,null,null);G.options.__file="src/components/content/edit/components/ContactUnavailabilityManager.vue";var Y=G.exports,j=(i(135),{mixins:[s.a,r.a],components:{ContactTimeline:c.a,ContactGroupManager:d.default,ContactProcessManager:D,ContactCapabilityManager:O,ContactRelationshipManager:R,ContactUnavailabilityManager:Y,FluroAvatarUpdate:l.a,FluroRealmSelect:n.default,FluroAcademicSelect:o.a},methods:{ping:function(t){var e=this;t.pinging=!0,e.$fluro.api.get("/push/ping/".concat(t._id),{cache:!1}).then((function(i){t.pinging=!1,e.$fluro.notify("Ping notification sent!")})).catch((function(i){t.pinging=!1,e.$fluro.error(i)}))},resetDevices:function(){var t=this;t.$fluro.api.get("/push/clear/".concat(t.itemID),{cache:!1}).then((function(e){t.$fluro.notify("Devices Reset!"),console.log("Reset")})).catch((function(e){t.$fluro.error(e)}))},toggleSubscription:function(t){switch(t){case"sms":this.unsubscribedSMS?this.subscribe("sms"):this.unsubscribe("sms");break;case"mailout":this.unsubscribedMailout?this.subscribe("mailout"):this.unsubscribe("mailout")}},subscribe:function(t){var e,i=this;switch(t){case"mailout":if(!i.emails||!i.emails.length)return void i.$fluro.error("No email addresses provided");e="/mailout/resubscribe";break;case"sms":if(!i.phoneNumbers||!i.phoneNumbers.length)return void i.$fluro.error("No phone numbers provided");e="/sms/resubscribe"}i.$fluro.api.post(e,{phoneNumbers:i.phoneNumbers,emails:i.emails}).then((function(){i.subscriptionCacheKey=Math.random()}))},unsubscribe:function(t){var e,i=this;switch(t){case"mailout":if(!i.emails||!i.emails.length)return void i.$fluro.error("No email addresses provided");e="/mailout/unsubscribe";break;case"sms":if(!i.phoneNumbers||!i.phoneNumbers.length)return void i.$fluro.error("No phone numbers provided");e="/sms/unsubscribe"}i.$fluro.api.post(e,{phoneNumbers:i.phoneNumbers,emails:i.emails}).then((function(){i.subscriptionCacheKey=Math.random()}))},updateAcademicCalendar:function(t){this.$set(this.model,"academicCalendar",t),this.update(this.model)},updateAcademicGrade:function(t){this.$set(this.model,"academicGrade",t),this.update(this.model)},updateFamily:function(){var t=_.chain(this.family).get("address").values().compact().value();t&&t.length?this.$set(this.model,"family",this.family):this.$delete(this.model,"family")},updateSheetRealms:function(t,e){t=this.$fluro.utils.arrayIDs(t);this.model.details[e]||this.$set(this.model.details,e,{}),this.$set(this.model.details[e],"realms",t)},updateSheet:function(t,e){this.model.details[e]||this.$set(this.model.details,e,{}),this.$set(this.model.details[e],"data",t)}},watch:{title:function(t){this.$set(this.model,"title",this.title),this.update(this.model)}},created:function(){var t=this;t.model.academicCalendar||t.$set(t.model,"academicCalendar",""),t.model.academicGrade||t.$set(t.model,"academicGrade",""),t.config&&t.config.details&&t.config.details.length&&(t.sheetDefinitions=_.reduce(t.config.details,(function(e,i){if(!i.fields||!i.fields.length)return e;var a=i.definitionName,o={_id:i._id,title:i.title,type:"group",key:a,fields:i.fields,asObject:!0,minimum:1,maximum:1,askCount:1},n=_.get(t.model,"details.".concat(a)),s=JSON.parse(JSON.stringify(n||{})),r={realms:[],data:{}};if(s&&s.items&&s.items.length){var l=s.items[0];l.data||(l.data={}),l.realms||(l.realms=[]),r=l}return t.$set(i,"dataModel",r),i.field=o,e.push(i),e}),[]),t.model.details||(t.model.details={}))},asyncComputed:{contactDefinitions:{default:[],get:function(){var t=this;return new Promise((function(e,i){t.$fluro.types.subTypes("contact").then((function(t){t=_.chain(t).filter((function(t){return"active"==t.status})).map((function(t,e){return{_id:t._id,name:t.title,value:t.definitionName}})).value();e(t)})).catch(i)}))}},devices:{default:[],get:function(){var t=this;return"edit"==t.context&&t.itemID?new Promise((function(e,i){t.$fluro.api.get("/contact/".concat(t.itemID,"/devices")).then((function(t){e(_.map(t.data,(function(t){return t.pinging=!1,t})))})).catch((function(t){i(t)}))})):Promise.resolve([])}},smsUnsubscribes:{default:[],get:function(){var t=this;return"edit"==t.context&&t.itemID?new Promise((function(e,i){t.$fluro.api.get("/contact/".concat(t.itemID,"/smsunsubscribes?").concat(t.subscriptionCacheKey)).then((function(t){e(t.data)})).catch((function(t){i(t)}))})):Promise.resolve([])}},mailoutUnsubscribes:{default:[],get:function(){var t=this;return"edit"==t.context&&t.itemID?new Promise((function(e,i){t.$fluro.api.get("/contact/".concat(t.itemID,"/unsubscribes?").concat(t.subscriptionCacheKey)).then((function(t){e(t.data)})).catch((function(t){i(t)}))})):Promise.resolve([])}}},computed:{fieldsOutput:function(){var t=[];function e(e,i){i.key=e,t.push(i)}return e("firstName",{title:"First Name",minimum:1,maximum:1,type:"string",placeholder:"Eg. Jessica"}),e("preferredName",{title:"Preferred/Nick Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. 'Jess'"}),e("middleName",{title:"Middle Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. 'Heather'"}),e("ethnicName",{title:"Ethnic Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. '吳爾霏'"}),e("maidenName",{title:"Maiden Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. 'Johnson'"}),e("lastName",{title:"Last Name",minimum:1,maximum:1,type:"string",placeholder:"Eg. Michaels"}),e("dob",{title:"Date of Birth",minimum:0,maximum:1,type:"date",directive:"date-select"}),e("dobVerified",{title:"Birthday type",minimum:0,maximum:1,type:"boolean",directive:"select",defaultValues:[!1],options:[{name:"It's a Guess",value:!1},{name:"It's Correct",value:!0}]}),e("family",{title:"Household / Primary Residence",minimum:0,maximum:1,type:"reference",directive:"reference-select",params:{restrictType:"family",template:{_context:"contact",title:this.model.lastName||"",realms:this.model.realms}}}),e("householdRole",{title:"Household Role",minimum:0,maximum:1,type:"string",directive:"select",options:[{name:"None",value:""},{name:"Parent",value:"parent"},{name:"Child",value:"child"}],params:{restrictType:"family"}}),e("deceased",{title:"Mark as deceased",minimum:0,maximum:1,type:"boolean",directive:"checkbox"}),e("deceasedDate",{title:"Deceased Date",minimum:0,maximum:1,type:"date",directive:"date-select"}),_.map(this.$fluro.date.timezones(),(function(t){return{name:t,value:t}})).unshift({name:"Use Account Default",value:""}),e("gender",{title:"Gender",minimum:1,maximum:1,type:"string",directive:"select",placeholder:"",options:[{name:"Male",value:"male"},{name:"Female",value:"female"},{name:"Unknown",value:"unknown"}]}),e("maritalStatus",{title:"Marital Status",minimum:0,maximum:1,type:"string",directive:"select",placeholder:"",options:[{name:"None",value:""},{name:"Single",value:"single"},{name:"In a relationship",value:"relationship"},{name:"Married",value:"married"},{name:"Widowed",value:"widowed"},{name:"Seperated",value:"seperated"},{name:"Divorced",value:"divorced"}]}),e("emails",{title:"Email Address",minimum:0,maximum:0,type:"email",placeholder:""}),e("phoneNumbers",{title:"Phone Number",minimum:0,maximum:0,type:"string",placeholder:"+61 400 123 456"}),e("timezone",{title:"Primary Timezone",minimum:0,maximum:1,type:"string",directive:"timezone-select",description:"Set a local timezone for this contact"}),e("countryCode",{title:"Default Country Code",minimum:0,maximum:1,type:"string",directive:"countrycodeselect"}),e("nametagNotes",{title:"Checkin Nametag Notes",minimum:0,maximum:1,type:"string"}),e("capabilities",{title:"Capabilities",minimum:0,maximum:0,type:"reference",description:"Add capabilities for this contact",params:{restrictType:"capability"}}),t},formOptions:function(){return{}},title:function(){return this.model?this.model.preferredName?"".concat(this.model.preferredName," ").concat(this.model.lastName||""):this.model.firstName?"".concat(this.model.firstName," ").concat(this.model.lastName||""):"":""},phoneNumbers:function(){return this.model.phoneNumbers},emails:function(){return this.model.emails},unsubscribedMailout:function(){return!!this.mailoutUnsubscribes.length},unsubscribedSMS:function(){return!!this.smsUnsubscribes.length},contextName:function(){var t=this.model.preferredName||this.model.firstName||"";return t&&t.length?_.endsWith(t,"s")?"".concat(t,"'"):"".concat(t,"'s"):""},definitionField:function(){return{title:"Contact Type / Definition",minimum:0,maximum:1,type:"string",directive:"select",key:"definition",options:this.contactDefinitions}},showOutline:function(){return!1},showPreferredName:function(){return this.model.preferredName&&this.model.preferredName.length||this.show.preferredName},showEthnicName:function(){return this.model.ethnicName&&this.model.ethnicName.length||this.show.ethnicName},showMiddleName:function(){return this.model.middleName&&this.model.middleName.length||this.show.middleName},showMaidenName:function(){return this.model.maidenName&&this.model.maidenName.length||this.show.maidenName}},data:function(){return{subscriptionCacheKey:0,sheetDefinitions:[],details:{},detailsModel:{},family:{},show:{preferredName:!1,middleName:!1,ethnicName:!1,maidenName:!1},familyFields:[{title:"Name of household",key:"title",minimum:0,maximum:1,expressions:{defaultValue:"data.lastName"}},{title:"Address",key:"address",minimum:1,maximum:1,askCount:1,type:"group",asObject:!0,fields:[{title:"Street Address Line 1",key:"addressLine1",minimum:0,maximum:1},{title:"Address Line 2",key:"addressLine2",minimum:0,maximum:1,expressions:{hide:"!data.addressLine1.length"},className:"xs12 sm6"},{type:"group",minimum:1,askCount:1,maximum:1,sameLine:1,fields:[{title:"Suburb",key:"suburb",minimum:0,maximum:1,className:"xs12 sm4"},{title:"State",key:"state",minimum:0,maximum:1,className:"xs12 sm4"},{title:"Postal Code",key:"postalCode",minimum:0,maximum:1,className:"xs12 sm4"}]}]}]}}}),z=(i(960),Object(h.a)(j,a,[],!1,null,"416e27af",null));z.options.__file="src/components/content/edit/panels/contact.vue";e.default=z.exports},798:function(t,e,i){"use strict";var a=i(35);e.a={props:{config:{type:Object,required:!0},context:{type:String,default:"new"}},data:function(){return{loading:!1}},mounted:function(){this.$set(this.model,"_type",this.config.type.definitionName)},extends:a.default,components:{FluroContentForm:a.default,FluroContentFormField:function(){return Promise.resolve().then(i.bind(null,47))},FluroPrivacySelect:function(){return i.e(55).then(i.bind(null,799))}},computed:{type:function(){return this.config.type},typeName:function(){return this.type?this.type.definitionName:""},itemID:function(){return this.model._id},definition:function(){return this.config.definition},definedFields:function(){return this.definition&&this.definition.fields&&this.definition.fields.length?this.definition.fields:[]},readableContentType:function(){return this.$fluro.types.readable(this.config.definition?this.config.definition.definitionName:this.config.type.definitionName)},fullBody:function(){return this.definition&&this.definition.data&&this.definition.data.fullBody},hideBody:function(){return this.definition&&this.definition.data&&this.definition.data.hideBody},titleLabel:function(){return"Title"},bodyLabel:function(){return"Body"}},methods:{}}},841:function(t,e,i){var a=i(957);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i(4).default)("3b8c1ab4",a,!1,{})},842:function(t,e,i){var a=i(959);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i(4).default)("80334e48",a,!1,{})},843:function(t,e,i){var a=i(961);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i(4).default)("ba3e89d8",a,!1,{})},909:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("fluro-page-preloader",{attrs:{contain:""}}):t._l(t.teamGroups,(function(e){return i("v-input",{staticClass:"no-flex"},[i("v-label",[t._v(t._s(e.title))]),t._v(" "),i("list-group",[t._l(e.teams,(function(e){return[i("list-group-item",{attrs:{item:e,firstLine:t._f("comma")(e.positions)},scopedSlots:t._u([{key:"right",fn:function(){return[i("v-menu",{attrs:{left:!0,fixed:!0,transition:"slide-y-transition","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on;return[i("v-btn",t._g({staticClass:"ma-0",attrs:{icon:"",small:"",flat:""}},o),[t.actionIndexes[e._id]?i("fluro-icon",{attrs:{icon:"times"}}):i("fluro-icon",{attrs:{icon:"ellipsis-h"}})],1)]}}],null,!0),model:{value:t.actionIndexes[e._id],callback:function(i){t.$set(t.actionIndexes,e._id,i)},expression:"actionIndexes[team._id]"}},[t._v(" "),i("v-list",{attrs:{dense:""}},[i("v-list-tile",{on:{click:function(i){return t.$actions.open([e])}}},[i("v-list-tile-content",[t._v("Actions")])],1),t._v(" "),t.canLeave(e)?i("v-list-tile",{on:{click:function(i){return t.leave(e)}}},[i("v-list-tile-content",[t._v("Remove "+t._s(t.model.firstName)+" from group")])],1):t._e()],1)],1)]},proxy:!0}],null,!0)})]}))],2),t._v(" "),t.canAdd(e.key)?[i("v-btn",{staticClass:"ml-0",attrs:{small:"",color:"primary"},on:{click:function(i){return t.select(e.key)}}},[t._v("\n                    Add "+t._s(e.title)+"\n                    "),i("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)]:t._e()],2)}))],2)};a._withStripped=!0;i(11),i(32),i(86);var o=i(146),n=i(147),s=i(99),r=i(148),l=i(25),c=i.n(l),d={props:{value:{type:Object,required:!0}},data:function(){return{actionIndexes:{},model:this.value,loading:!0,newGroups:[],teams:[]}},created:function(){console.log("RELOAD TEAMS"),this.reloadTeams()},methods:{canLeave:function(t){var e=t.definition;return this.$fluro.access.can("leave",e,"team")||this.$fluro.access.canEditItem(t)},canAdd:function(t){var e=this.$fluro.access.can("join",t,"team"),i=this.$fluro.access.can("edit",t,"team");return e||i},leave:function(t){var e=this,i=e.$fluro.utils.getStringID(t);e.loading=!0;e.$batch.run({operation:"remove from team",ids:[e.contactID],teams:[i]}).then((function(t){var a=_.findIndex(e.teams,{_id:i});e.teams.splice(a,1),e.loading=!1})).catch((function(t){console.log("TEAMS ERR",t),e.reloadTeams()}))},select:function(t){var e=this,i=new(c.a.extend(r.a))({propsData:{minimum:0,maximum:0}});e.$fluro.modal({component:s.a,options:{allDefinitions:!1,selector:i,type:t,minimum:0,maximum:0}}).then((function(t){if(t&&t.length){e.loading=!0;var i=e.$fluro.utils.arrayIDs(t);e.$batch.run({operation:"add to team",ids:[e.contactID],teams:i}).then((function(t){console.log("TEAMS ADDED",t),e.reloadTeams()})).catch((function(t){console.log("TEAMS ERR",t),e.reloadTeams()}))}}))},reloadTeams:function(){var t=this;t.loading=!0,t.$fluro.api.get("/contact/".concat(t.contactID,"/teams")).then((function(e){t.teams=e.data,t.loading=!1})).catch((function(e){t.loading=!1}))}},components:{ListGroup:o.a,ListGroupItem:n.a,FluroContentSelectModal:s.a},computed:{contactID:function(){return this.$fluro.utils.getStringID(this.model)},teamGroups:function(){var t=this,e=_.reduce(t.teamDefinitions,(function(t,e){return t[e.definitionName]={title:e.plural,teams:[],key:e.definitionName},t}),{team:{title:"Groups and Teams",teams:[],key:"team"}});return _.chain(t.teams).reduce((function(e,i){var a=i.definition||"team",o=e[a];return o||(o=e[a]={title:t.$fluro.types.readable(a,!0),teams:[]}),o.teams.push(i),e}),e).values().orderBy((function(t){return t.teams.length})).reverse().value()}},asyncComputed:{teamDefinitions:{default:[],get:function(){return this.$fluro.types.subTypes("team")}}}},u=i(0),m=Object(u.a)(d,a,[],!1,null,null,null);m.options.__file="src/components/content/edit/components/ContactGroupManager.vue";e.default=m.exports},956:function(t,e,i){"use strict";var a=i(841);i.n(a).a},957:function(t,e,i){(t.exports=i(3)(!1)).push([t.i,".process-state-card .fluro-card{position:relative;overflow:hidden;box-shadow:0 2px 3px rgba(0,0,0,0.1)}.process-state-card .due-date{font-style:italic;float:right}.process-state-card .color-block{width:3px;top:0;left:0;bottom:0;position:absolute}.process-state-card .fluro-card-body{padding:10px}.process-state-card.archived .fluro-card{opacity:0.5;background:none}.process-state-card.complete .fluro-card{color:#004d00;background:#4dff4d;border-color:rgba(0,128,0,0.1)}.process-state-card.complete .fluro-card .color-block{background:linear-gradient(#89e10c, #16d3ad) !important}.process-state-card.pending .fluro-card{color:#ec7b1f;background:#fceadb;border-color:rgba(240,151,78,0.1)}.process-state-card.pending .fluro-card .color-block{background:linear-gradient(#f0974e, #f0974e) !important}.process-state-card.failed .fluro-card,.process-state-card.overdue .fluro-card{color:#c00;background:#ffd1d1;border-color:rgba(255,0,0,0.1)}.process-state-card.failed .fluro-card:before,.process-state-card.overdue .fluro-card:before{display:block;background:linear-gradient(#ff4d83, #ff003c);animation-name:pulse_opacity;animation-duration:3s;animation-iteration-count:infinite;animation-timing-function:linear}.process-state-card.failed .fluro-card .color-block,.process-state-card.overdue .fluro-card .color-block{background:linear-gradient(#ff4d83, #ff003c) !important}.process-dots{display:block;white-space:nowrap}.process-dots.process-dots-flex{display:flex}.process-dots .process-dot{color:rgba(0,0,0,0.3)}.process-dots .process-dot.failed{color:red}.process-dots .process-dot.pending{color:#f0974e}.process-dots .process-dot.complete{color:green}\n",""])},958:function(t,e,i){"use strict";var a=i(842);i.n(a).a},959:function(t,e,i){(t.exports=i(3)(!1)).push([t.i,".anniversary{font-weight:normal;opacity:0.5}.relation-faces{display:block}.relation-faces .relation-face{width:100px;padding:10px;background:#fff;border:1px solid rgba(0,0,0,0.1);border-radius:4px;margin:0 1% 1% 0;display:inline-block;text-align:center;font-size:14px;cursor:pointer;vertical-align:top}.relation-faces .relation-face:hover{background:#fafafa}.relation-faces .relation-face.archived{opacity:0.5;border:1px solid rgba(0,0,0,0.1);background:none}.relation-faces .relation-face .details{padding:5px 0;text-transform:capitalize;font-size:0.8em;opacity:0.8}\n",""])},960:function(t,e,i){"use strict";var a=i(843);i.n(a).a},961:function(t,e,i){(t.exports=i(3)(!1)).push([t.i,".hint[data-v-416e27af]{font-size:10px;opacity:0.5;color:inherit;display:block}.bordered[data-v-416e27af]{border:1px solid rgba(0,0,0,0.1);box-shadow:0 2px 4px rgba(0,0,0,0.1)}.bordered[data-v-416e27af] .tabset-menu{background:#eee}\n",""])}}]);