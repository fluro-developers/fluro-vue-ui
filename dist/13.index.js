(window.webpackJsonp=window.webpackJsonp||[]).push([[13,65],{463:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flex-column",[e.loading?[a("fluro-page-preloader",{attrs:{contain:""}})]:a("tabset",{attrs:{justified:!0,vertical:!0},scopedSlots:e._u([{key:"menuprefix",fn:function(){return["edit"==e.context&&e.$vuetify.breakpoint.mdAndUp?[a("flex-column-header",{staticStyle:{"text-align":"center"}},[a("div",{staticStyle:{padding:"10px","max-width":"200px",margin:"auto"}},[a("fluro-avatar-update",{attrs:{id:e.model._id,type:"contact"}})],1),e._v(" "),a("v-container",{staticClass:"border-bottom text-xs-center",attrs:{"px-0":"",fluid:""}},[a("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1 ml-0",attrs:{disabled:!e.canEmail,icon:"",color:"primary",content:"Send Email"},on:{click:function(t){return e.communicate("email")}}},[a("fluro-icon",{attrs:{library:"fas",icon:"envelope"}})],1),e._v(" "),a("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1",attrs:{disabled:!e.canSMS,icon:"",color:"primary",content:"Send SMS"},on:{click:function(t){return e.communicate("sms")}}},[a("fluro-icon",{attrs:{library:"fas",icon:"comment"}})],1),e._v(" "),a("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1",attrs:{disabled:!e.canCall,icon:"",color:"primary",content:"Call"},on:{click:function(t){return e.communicate("phone")}}},[a("fluro-icon",{attrs:{library:"fas",icon:"phone"}})],1),e._v(" "),a("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1",attrs:{disabled:!e.canPost,icon:"",color:"primary",content:"Add Post/Note"},on:{click:e.addPost}},[a("fluro-icon",{attrs:{library:"fas",type:"post"}})],1),e._v(" "),a("v-btn",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"ma-0 mx-1 mr-0",attrs:{icon:"",color:"primary",content:"Add to Address Book"},on:{click:function(t){return e.communicate("vcard")}}},[a("fluro-icon",{attrs:{library:"fas",icon:"address-book"}})],1)],1)],1)]:e._e()]},proxy:!0}])},[e._v(" "),a("tab",{attrs:{heading:"Basic Details"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",{staticClass:"grid-list-xl"},[a("constrain",{attrs:{sm:""}},[a("h3",{attrs:{margin:""}},[e._v("Basic Details")]),e._v(" "),e.$vuetify.breakpoint.xsOnly?["edit"==e.context?[a("div",{staticStyle:{"max-width":"200px",margin:"auto"}},[a("fluro-avatar-update",{attrs:{id:e.model._id,type:"contact"}})],1)]:e._e()]:e._e(),e._v(" "),a("wrapper",{attrs:{xs:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{class:{xs12:e.$vuetify.breakpoint.xsOnly}},[a("fluro-content-form-field",{staticClass:"right-messages",attrs:{autofocus:e.$vuetify.breakpoint.smAndUp,"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.firstName},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),e._v(" "),e.showPreferredName?a("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.preferredName},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}):e._e(),e._v(" "),e.showEthnicName?a("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.ethnicName},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}):e._e(),e._v(" "),a("div",{staticClass:"additions"},[e.showPreferredName?e._e():a("a",{staticClass:"hint",on:{click:function(t){e.show.preferredName=!0}}},[e._v("Add Nick/Preferred Name")]),e._v(" "),e.showEthnicName?e._e():a("a",{staticClass:"hint",on:{click:function(t){e.show.ethnicName=!0}}},[e._v("Add Ethnic Name")])])],1),e._v(" "),e.showMiddleName?a("v-flex",{class:{xs12:e.$vuetify.breakpoint.xsOnly}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.middleName},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1):e._e(),e._v(" "),a("v-flex",{class:{xs12:e.$vuetify.breakpoint.xsOnly}},[a("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.lastName},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),e._v(" "),e.showMaidenName?a("fluro-content-form-field",{staticClass:"right-messages",attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.maidenName},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}):e._e(),e._v(" "),a("div",{staticClass:"additions"},[e.showMiddleName?e._e():a("a",{staticClass:"hint",on:{click:function(t){e.show.middleName=!0}}},[e._v("Add Middle Name")]),e._v(" "),e.showMaidenName?e._e():a("a",{staticClass:"hint",on:{click:function(t){e.show.maidenName=!0}}},[e._v("Add Maiden Name")])])],1)],1),e._v(" "),e.contactDefinitions.length?[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.definitionField},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]:e._e()],2),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:""}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.gender},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.maritalStatus},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:""}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,options:e.formOptions,field:e.fieldHash.emails},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,options:e.formOptions,field:e.fieldHash.phoneNumbers},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs6:""}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.dob},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),a("v-flex",{attrs:{xs6:""}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.dobVerified},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.timezone},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),e._v(" "),a("wrapper",{attrs:{xs:""}},[a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v("School / Academic Details")]),e._v(" "),a("fluro-academic-select",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions},on:{calendar:e.updateAcademicCalendar,grade:e.updateAcademicGrade},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v("Checkin Nametag Notes")]),e._v(" "),a("p",{staticClass:"help-block"},[e._v("Publicly displayed notes to be printed on "+e._s(e.contextName)+" nametag")]),e._v(" "),a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,showLabel:!1,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.nametagNotes},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],2)],1)],1)])],2),e._v(" "),e.itemID?a("tab",{attrs:{heading:"Activity Timeline"}},[a("tabset",{attrs:{justified:!0}},[a("tab",{attrs:{heading:"Timeline"}},[a("contact-timeline",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1):e._e(),e._v(" "),a("tab",{attrs:{heading:"Household & Relationships"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",{attrs:{"grid-list-xl":""}},[a("constrain",{attrs:{sm:""}},["edit"==e.context?[a("h3",{attrs:{margin:""}},[e._v("Household / Residence")]),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:""}},[a("fluro-content-form-field",{attrs:{"override-label":e.contextName+" Household Role","form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.householdRole},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),e._v(" "),a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v("Family Household")]),e._v(" "),a("p",{staticClass:"help-block"},[e._v("Select "+e._s(e.contextName)+" primary residence")]),e._v(" "),a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,showLabel:!1,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.family},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)]:[a("h3",{attrs:{margin:""}},[e._v("Household")]),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:""}},[a("fluro-content-form-field",{attrs:{"override-label":e.contextName+" Household Role","form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.householdRole},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),e._v(" "),e.model._id?[a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v("Family Household")]),e._v(" "),a("p",{staticClass:"help-block"},[e._v("Select "+e._s(e.contextName)+" primary residence")]),e._v(" "),a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,showLabel:!1,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.family},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)]:a("fluro-panel",[a("tabset",[a("tab",{attrs:{heading:"Create new Household"}},[a("v-container",[a("fluro-content-form",{attrs:{options:e.formOptions,fields:e.familyFields},on:{input:e.updateFamily},model:{value:e.family,callback:function(t){e.family=t},expression:"family"}})],1)],1),e._v(" "),a("tab",{attrs:{heading:"Add to existing Household"}},[a("v-container",[a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v("Family Household")]),e._v(" "),a("p",{staticClass:"help-block"},[e._v("Select "+e._s(e.contextName)+" primary residence")]),e._v(" "),a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,showLabel:!1,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.family},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1)],1)],1)],e._v(" "),a("h3",{attrs:{margin:""}},[e._v("Relationships")]),e._v(" "),a("contact-relationship-manager",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],2)],1)],1)])],2),e._v(" "),e.model._id?a("tab",{attrs:{heading:"Groups & Teams"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",[a("constrain",{attrs:{sm:""}},[a("h3",{attrs:{margin:""}},[e._v(e._s(e.contextName)+" Groups & Teams")]),e._v(" "),a("contact-group-manager",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1)])],2):e._e(),e._v(" "),e.model._id?a("tab",{attrs:{heading:"Processes"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",[a("constrain",{attrs:{sm:""}},[a("h3",{attrs:{margin:""}},[e._v(e._s(e.contextName)+" Progress")]),e._v(" "),a("contact-process-manager",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1)],1)])],2):e._e(),e._v(" "),a("tab",{attrs:{heading:"Capabilities"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",{attrs:{"grid-list-xl":""}},[a("constrain",{attrs:{sm:""}},[a("h3",{attrs:{margin:""}},[e._v(e._s(e.contextName)+" Capabilities")]),e._v(" "),a("contact-capability-manager",{model:{value:e.model.capabilities,callback:function(t){e.$set(e.model,"capabilities",t)},expression:"model.capabilities"}})],1)],1)],1)])],2),e._v(" "),"edit"==e.context?a("tab",{attrs:{heading:"Rostering / Availability"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",{attrs:{"grid-list-xl":""}},[a("constrain",{attrs:{sm:""}},[e.model._id?a("div",[a("h3",{attrs:{margin:""}},[e._v(e._s(e.contextName)+" Unavailability")]),e._v(" "),a("contact-unavailability-manager",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1):e._e()])],1)],1)])],2):e._e(),e._v(" "),"edit"==e.context?a("tab",{attrs:{heading:"Notifications"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",{attrs:{"grid-list-xl":""}},[a("constrain",{attrs:{sm:""}},[a("h3",{attrs:{margin:""}},[e._v("Notifications")]),e._v(" "),a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.countryCode},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),e._v(" "),e.phoneNumbers.length||e.emails.length?a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v("Communication Preferences")]),e._v(" "),a("p",{staticClass:"help-block"},[e._v("Manage "+e._s(e.contextName)+" subscription preferences below")]),e._v(" "),a("div",{staticClass:"toggle-items"},[e.emails.length?[a("fluro-toggle-item",{attrs:{inactive:e.unsubscribedMailout},nativeOn:{click:function(t){return e.toggleSubscription("mailout")}}},[e._v("\n                                            Allow Promotional Emails\n                                        ")])]:e._e(),e._v(" "),e.phoneNumbers.length?[a("fluro-toggle-item",{attrs:{inactive:e.unsubscribedSMS},nativeOn:{click:function(t){return e.toggleSubscription("sms")}}},[e._v("\n                                            Allow Promotional SMS\n                                        ")])]:e._e()],2)],1):e._e(),e._v(" "),a("p"),e._v(" "),e.devices.length?a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v(e._s(e.contextName)+" Connected Devices")]),e._v(" "),a("list-group",e._l(e.devices,(function(t){return a("list-group-item",{scopedSlots:e._u([{key:"left",fn:function(){return[a("fluro-icon",{attrs:{icon:"mobile"}})]},proxy:!0},{key:"default",fn:function(){return[a("div",[a("strong",{staticClass:"text-capitalize"},[e._v("\n                                                    "+e._s(t.application)+" - "+e._s(t.metadata.model)+"\n                                                ")]),e._v(" "),a("div",{staticClass:"sm text-muted"},[e._v(e._s(t.metadata.platform)+" "+e._s(t.metadata.version))])])]},proxy:!0},{key:"right",fn:function(){return[a("v-btn",{attrs:{small:"",loading:t.pinging},on:{click:function(a){return e.ping(t)}}},[e._v("\n                                                Ping\n                                            ")])]},proxy:!0}],null,!0)})})),1),e._v(" "),a("p",{staticClass:"help-block"},[e._v("\n                                    If you are experiencing problems with push notifications it can sometimes be helpful to reset all devices for a contact allowing them to reconnect next time they sign in to an application\n                                ")]),e._v(" "),a("v-btn",{attrs:{small:""},on:{click:function(t){return e.resetDevices()}}},[a("span",[e._v("Reset all devices")]),e._v(" "),a("fluro-icon",{attrs:{icon:"trash"}})],1)],1):e._e()],1)],1)],1)])],2):e._e(),e._v(" "),e._l(e.sheetDefinitions,(function(t){return a("tab",{key:t._id,attrs:{heading:t.title}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",[a("constrain",{attrs:{sm:""}},[a("h3",{attrs:{margin:""}},[e._v(e._s(t.title))]),e._v(" "),a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v("Realms")]),e._v(" "),a("p",{staticClass:"help-block"},[e._v("Select where "+e._s(e.contextName)+" "+e._s(t.title)+" information should be stored")]),e._v(" "),a("fluro-realm-select",{attrs:{type:"contactdetail",definition:t.definitionName},on:{input:function(a){return e.updateSheetRealms(a,t.definitionName)}},model:{value:t.dataModel.realms,callback:function(a){e.$set(t.dataModel,"realms",a)},expression:"sheet.dataModel.realms"}})],1),e._v(" "),a("fluro-content-form",{attrs:{options:e.formOptions,fields:t.fields},on:{input:function(a){return e.updateSheet(a,t.definitionName)}},model:{value:t.dataModel.data,callback:function(a){e.$set(t.dataModel,"data",a)},expression:"sheet.dataModel.data"}})],1)],1)],1)])],2)})),e._v(" "),"edit"==e.context?a("tab",{attrs:{heading:"Metadata"}},[e._t("default",[a("flex-column-body",{staticStyle:{background:"#fafafa"}},[a("v-container",[a("constrain",{attrs:{sm:""}},[a("h3",{attrs:{margin:""}},[e._v("Metadata")]),e._v(" "),a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.timezone},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),e._v(" "),a("v-layout",[a("v-flex",[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.deceased},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),a("v-flex",{directives:[{name:"show",rawName:"v-show",value:e.model.deceased,expression:"model.deceased"}]},[a("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.formOptions,field:e.fieldHash.deceasedDate},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),e._v(" "),e.model.data?a("div",[a("v-card",[a("v-card-text",[a("h5",[e._v("Explore Metadata")]),e._v(" "),a("json-view",{attrs:{deep:3,data:e.model.data}})],1)],1)],1):e._e()],1)],1)],1)])],2):e._e()],2)],2)};i._withStripped=!0;var o=a(180),s=a(19),n=a(512),r=a(176),l=a(179),d=a(183),c=a(623),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loading?a("fluro-page-preloader",{attrs:{contain:""}}):[e.sorted.length?e._l(e.sorted,(function(t){return a("contact-process-state",{attrs:{card:t},nativeOn:{click:function(a){return e.clicked(t)}}})})):[a("em",[e._v("No process information is available")])]]],2)};u._withStripped=!0;var m=a(46),p=a(47),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"process-state-card",class:e.card.processStatus},[a("fluro-card",[a("div",{staticClass:"color-block"}),e._v(" "),a("fluro-card-body",[e.card.dueDate?a("div",{staticClass:"due-date"},[a("fluro-icon",{attrs:{icon:"clock"}}),e._v(" "+e._s(e.dueText))],1):e._e(),e._v(" "),a("h5",[e._v(e._s(e.card.title))]),e._v(" "),a("div",[a("strong",[e._v(e._s(e.currentState.title))]),e._v(" "),"linear"==e.mode?[e._v(" - "+e._s(e.percent))]:e._e()],2),e._v(" "),a("div",[e._v(e._s(e.taskSummary))]),e._v(" "),a("div",{staticClass:"process-dots"},e._l(e.renderStates,(function(e){return a("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"process-dot",class:e.result,attrs:{content:e.title}},[a("fluro-icon",{attrs:{library:e.iconLibrary,icon:e.icon}})],1)})),0)])],1)],1)};f._withStripped=!0;var v={props:{card:{type:Object,required:!0}},computed:{taskSummary(){return this.formsPending?`Awaiting ${this.formsPending} form response${1==this.formsPending?"":"s"}`:this.tasksIncomplete?`${this.tasksIncomplete} task${1==this.tasksIncomplete?"":"s"}`:void 0},tasksIncomplete(){return parseInt(this.card.taskCount.incomplete)},formsPending(){return parseInt(this.card.taskCount.formsRequested)-parseInt(this.card.taskCount.formsCompleted)},processStatus(){return this.card.processStatus},dueDate(){return this.card.dueDate},dueText(){if(this.dueDate)switch(this.processStatus){case"complete":return"Will progress "+this.$fluro.date.timeago(this.card.dueDate);default:return"Due "+this.$fluro.date.timeago(this.card.dueDate)}},renderStates(){var e=this;return _.chain(e.states).filter((function(e){return"waiting"!=e.style})).map((function(t){if(t.iconLibrary="fas",t.key==e.state)return t.iconLibrary="far",t.icon="dot-circle",t;switch(t.result){case"failed":t.icon="exclamation-circle";break;case"complete":t.icon="check-circle";break;default:t.icon="circle",t.iconLibrary="far"}return t})).value()},currentStep(){return _.findIndex(this.states,{key:this.state})},totalSteps(){return this.states.length},percent(){return Math.ceil(this.currentStep/this.totalSteps*100)+"%"},currentIndex(){return _.findIndex(this.states,{key:this.state})},state(){return this.card.state},states(){return this.card.states},mode(){return this.card.mode},stateLookup(){return _.reduce(this.card.states,(function(e,t){return e[t.key]=t,e}),{})},currentState(){var e=_.find(this.states,{key:this.state});return e||{title:"Stuck / Limbo",key:"_limbo"}}}},h=(a(669),a(0)),b=Object(h.a)(v,f,[],!1,null,null,null);b.options.__file="src/components/content/edit/components/ContactProcessState.vue";var g=b.exports,y=a(7),x=a.n(y),k={props:{value:{type:Object,required:!0}},data(){return{actionIndexes:{},model:this.value,loading:!0,cards:[]}},created(){this.reloadCards()},methods:{clicked(e){var t=this;return t.$fluro.global.edit(e,!0).then((function(e){console.log("Result!",e),t.reloadCards()})).catch((function(e){console.log("Cancelled!",e)}))},reloadCards(){var e=this;return e.loading=!0,e.$fluro.api.get("/process/states/"+e.contactID).then((function(t){e.cards=t.data,e.loading=!1})).catch((function(t){e.cards=t,e.loading=!1}))}},components:{ListGroup:m.a,ListGroupItem:p.a,ContactProcessState:g},computed:{sorted(){return _.orderBy(this.cards,this.$fluro.utils.processCardPrioritySort)},contactID(){return this.$fluro.utils.getStringID(this.model)}}},N=Object(h.a)(k,u,[],!1,null,null,null);N.options.__file="src/components/content/edit/components/ContactProcessManager.vue";var D=N.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loading?a("fluro-page-preloader",{attrs:{contain:""}}):e._l(e.capabilityGroups,(function(t){return a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v(e._s(t.title))]),e._v(" "),a("list-group",[e._l(t.capabilities,(function(t){return[a("list-group-item",{attrs:{item:t},scopedSlots:e._u([{key:"right",fn:function(){return[a("v-btn",{staticClass:"ma-0",attrs:{small:"",icon:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.remove(t)}}},[a("fluro-icon",{attrs:{icon:"times"}})],1)]},proxy:!0}],null,!0)})]}))],2),e._v(" "),a("v-btn",{staticClass:"ml-0",attrs:{small:"",color:"primary"},on:{click:function(a){return e.select(t.key)}}},[e._v("\n                Add "+e._s(t.title)+"\n                "),a("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)],1)}))],2)};w._withStripped=!0;var C=a(26),$=a(48),S={props:{value:{type:Array,required:!0}},data(){return{loading:!0,actionIndexes:{},model:this.value}},created(){},methods:{remove(e){var t=this.model.indexOf(e);this.model.splice(t,1)},addItem(e){_.some(this.model,{_id:e._id})||this.model.push(e)},select(e){var t=this,a=new(x.a.extend($.a))({propsData:{minimum:0,maximum:0}});t.$fluro.modal({component:C.a,options:{allDefinitions:!1,selector:a,type:e,minimum:0,maximum:0}}).then((function(e){e&&e.length&&(console.log("Items"),_.each(e,(function(e){t.addItem(e)})))}))}},components:{ListGroup:m.a,ListGroupItem:p.a,FluroContentSelectModal:C.a},computed:{capabilityGroups(){var e=this,t=_.reduce(e.capabilityDefinitions,(function(e,t){return e[t.definitionName]={title:t.plural,capabilities:[],key:t.definitionName},e}),{capability:{title:"Capabilities",capabilities:[],key:"capability"}});return _.chain(e.model).reduce((function(t,a){var i=a.definition||"capability",o=t[i];return o||(o=t[i]={title:e.$fluro.types.readable(i,!0),capabilities:[]}),o.capabilities.push(a),t}),t).values().value()}},asyncComputed:{capabilityDefinitions:{default:[],get(){var e=this;return e.loading=!0,new Promise((function(t,a){e.$fluro.types.subTypes("capability").then((function(a){t(a),e.loading=!1})).catch((function(t){a(t),e.loading=!1}))}))}}}},M=Object(h.a)(S,w,[],!1,null,null,null);M.options.__file="src/components/content/edit/components/ContactCapabilityManager.vue";var O=M.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loading?a("fluro-page-preloader",{attrs:{contain:""}}):[a("v-layout",{attrs:{row:"",wrap:""}},[e._l(e.backlinks,(function(t){return[a("v-flex",[a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v(e._s(e._f("capitalize")(t.relationship))+" "),a("span",{staticClass:"anniversary"},[e._v(e._s(e.anniversaryDate(t)))])]),e._v(" "),a("div",{staticClass:"relation-faces"},e._l(t.contacts,(function(t){return a("div",{staticClass:"relation-face",class:t.status,on:{click:function(a){return e.$fluro.global.edit(t,!0)}}},[a("fluro-avatar",{attrs:{lg:"",id:t}}),e._v(" "),a("div",{staticClass:"details"},[a("div",[a("strong",[e._v(e._s(t.title))])]),e._v(" "),a("div",[e._v(e._s(t.householdRole))]),e._v(" "),a("div",[e._v(e._s(t.gender))]),e._v(" "),a("div",[e._v(e._s(t.age))]),e._v(" "),a("div",[e._v(e._s(e._f("definitionTitle")(t.definition)))]),e._v(" "),a("fluro-status-label",{attrs:{value:t.status}})],1)],1)})),0)],1)],1)]})),e._v(" "),e._l(e.model.relationships,(function(t){return[a("v-flex",[a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v(e._s(e.contextName)+" "+e._s(e._f("capitalize")(t.relationship))+" "),a("span",{staticClass:"anniversary"},[e._v(e._s(e.anniversaryDate(t)))])]),e._v(" "),a("div",{staticClass:"relation-faces"},e._l(t.contacts,(function(t){return a("div",{staticClass:"relation-face",class:t.status,on:{click:function(a){return e.$fluro.global.edit(t,!0)}}},[a("fluro-avatar",{attrs:{lg:"",id:t}}),e._v(" "),a("div",{staticClass:"details"},[a("div",[a("strong",[e._v(e._s(t.title))])]),e._v(" "),a("div",[e._v(e._s(t.householdRole))]),e._v(" "),a("div",[e._v(e._s(t.gender))]),e._v(" "),a("div",[e._v(e._s(t.age))]),e._v(" "),a("div",[e._v(e._s(e._f("definitionTitle")(t.definition)))]),e._v(" "),a("fluro-status-label",{attrs:{value:t.status}})],1)],1)})),0)],1)],1)]}))],2),e._v(" "),a("fluro-panel",[a("fluro-panel-title",[a("h4",[e._v("Add a relationship")])]),e._v(" "),a("fluro-panel-body",[a("form",[a("v-layout",[a("v-flex",{attrs:{xs12:"",sm5:""}},[a("v-select",{attrs:{label:"Relationship","item-text":"title",items:e.relationshipTypes},model:{value:e.proposed.relationshipType,callback:function(t){e.$set(e.proposed,"relationshipType",t)},expression:"proposed.relationshipType"}}),e._v(" "),e.customRelationship?[a("v-text-field",{attrs:{label:"Custom Relationshp",placeholder:"Boss, Coworker, Friend"},model:{value:e.proposed.relationship,callback:function(t){e.$set(e.proposed,"relationship",t)},expression:"proposed.relationship"}})]:e._e(),e._v(" "),"spouse"==e.proposed.relationship?[a("fluro-content-form-field",{attrs:{field:e.anniversaryField},model:{value:e.proposed,callback:function(t){e.proposed=t},expression:"proposed"}})]:e._e()],2),e._v(" "),a("v-flex",{attrs:{xs12:"",sm5:""}},[a("fluro-content-select-button",{attrs:{block:"",type:"contact"},model:{value:e.proposed.contacts,callback:function(t){e.$set(e.proposed,"contacts",t)},expression:"proposed.contacts"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-btn",{attrs:{block:"",color:"primary",disabled:e.disabled},on:{click:function(t){return e.add()}}},[e._v("\n                                Add\n                                "),a("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)],1)],1)],1)])],1)]],2)};I._withStripped=!0;var F=a(17),A=a(11),P={props:{value:{type:Object,required:!0}},data(){return{anniversaryField:{key:"anniversary",type:"date",title:"Anniversary Date"},actionIndexes:{},model:this.value,loading:!0,backlinks:[],proposed:{checkinAuthorised:!0,relationshipType:null,relationship:null,anniversary:null,contacts:[]}}},created(){console.log("RELOAD TEAMS"),this.reloadRelationships(),this.resetProposed()},methods:{anniversaryDate(e){if(e.anniversary)return`${this.$fluro.date.formatDate(e.anniversary,"D MMM")} (${this.$fluro.date.timeago(e.anniversary)})`},add(){var e=this.proposed;this.model.relationships&&this.model.relationships.length||this.$set(this.model,"relationships",[]),this.model.relationships.push(e),this.resetProposed()},resetProposed(){this.proposed={checkinAuthorised:!0,relationshipType:null,relationship:null,anniversary:null,contacts:[]}},reloadRelationships(){var e=this;e.loading=!0,e.contactID?e.$fluro.api.get(`/contact/${e.contactID}/relationships`,{params:{backlinks:!0}}).then((function(t){e.backlinks=t.data,e.loading=!1})).catch((function(t){e.loading=!1})):e.loading=!1}},components:{FluroContentFormField:A.default,FluroContentSelectButton:F.default,ListGroup:m.a,ListGroupItem:p.a},watch:{"proposed.relationshipType":function(e){this.customRelationship||(this.proposed.relationship=e)}},computed:{relationships(){return this.backlinks},customRelationship(){return"other"==this.proposed.relationshipType},disabled(){return!(this.proposed.contacts&&this.proposed.contacts.length&&this.proposed.relationship&&this.proposed.relationship.length)||(!(!this.customRelationship||this.proposed.relationship&&this.proposed.relationship.length)||void 0)},contextName(){var e=this.model.preferredName||this.model.firstName||"";return e&&e.length?_.endsWith(e,"s")?e+"'":e+"'s":""},relationshipTypes(){var e=this.contextName;return[{title:e+" Parents",value:"parents"},{title:e+" Guardians",value:"guardians"},{title:e+" Children",value:"children"},{title:e+" Siblings",value:"siblings"},{title:e+" Spouse",value:"spouse"},{title:e+" Partner",value:"partner"},{title:e+" Grandparents",value:"grandparents"},{title:e+" Grandchildren",value:"grandchildren"},{title:e+" Aunt/Uncle",value:"auntuncle"},{title:e+" Niece/Nephew",value:"niecenephew"},{title:"Other",value:"other"}]},contactID(){if(this.model._id)return this.$fluro.utils.getStringID(this.model)}},filters:{capitalize:e=>_.startCase(e)}},E=(a(671),Object(h.a)(P,I,[],!1,null,null,null));E.options.__file="src/components/content/edit/components/ContactRelationshipManager.vue";var R=E.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loading?a("fluro-page-preloader",{attrs:{contain:""}}):[a("list-group",[a("transition-group",e._l(e.unavailabilities,(function(t,i){return a("list-group-item",{key:JSON.stringify(t),staticClass:"ma-0 pa-0"},[a("v-layout",{attrs:{wrap:"","align-center":"","ma-0":""}},[a("v-flex",{attrs:{sm10:"",xs12:"","px-4":""}},[a("strong",[e._v(e._s(t.description))]),e._v(" "),a("p",{staticClass:"muted mb-0"},[e._v(e._s(e._f("readableDate")(t)))])]),e._v(" "),a("v-flex",{attrs:{sm2:"",xs12:""}},[a("fluro-confirm-button",{attrs:{content:"Remove"},on:{click:function(t){return e.remove(i)}},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.confirming;return[a("v-btn",{staticStyle:{transition:"all 0.1s",width:"100%"},attrs:{flat:"",block:"",color:i?"red":""}},[e._v(e._s(i?"Confirm?":"Remove"))])]}}],null,!0)})],1)],1)],1)})),1)],1),e._v(" "),a("fluro-panel",[a("fluro-panel-title",[a("h4",[e._v("Add an Unavailability Period")])]),e._v(" "),a("fluro-panel-body",[a("form",[a("v-layout",{attrs:{wrap:"","px-4":""}},[a("v-flex",{attrs:{xs12:"",sm12:""}},[a("fluro-content-form-field",{attrs:{field:e.description},model:{value:e.proposed,callback:function(t){e.proposed=t},expression:"proposed"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm5:""}},[a("v-dialog",{ref:"dialogStart",attrs:{"return-value":e.proposed.startDate,lazy:"","full-width":"",width:"290px"},on:{"update:returnValue":function(t){return e.$set(e.proposed,"startDate",t)},"update:return-value":function(t){return e.$set(e.proposed,"startDate",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-text-field",e._g({attrs:{label:"Start Date","prepend-icon":"event",readonly:""},model:{value:e.proposed.startDate,callback:function(t){e.$set(e.proposed,"startDate",t)},expression:"proposed.startDate"}},i))]}}]),model:{value:e.modalStart,callback:function(t){e.modalStart=t},expression:"modalStart"}},[e._v(" "),a("v-date-picker",{attrs:{min:e.startDateMin,scrollable:""},model:{value:e.proposed.startDate,callback:function(t){e.$set(e.proposed,"startDate",t)},expression:"proposed.startDate"}},[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(t){e.modalStart=!1}}},[e._v("Cancel")]),e._v(" "),a("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(t){return e.$refs.dialogStart.save(e.proposed.startDate)}}},[e._v("OK")])],1)],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm5:""}},[a("v-dialog",{ref:"dialogEnd",attrs:{"return-value":e.proposed.endDate,lazy:"","full-width":"",width:"290px"},on:{"update:returnValue":function(t){return e.$set(e.proposed,"endDate",t)},"update:return-value":function(t){return e.$set(e.proposed,"endDate",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-text-field",e._g({attrs:{label:"End Date","prepend-icon":"event",readonly:""},model:{value:e.proposed.endDate,callback:function(t){e.$set(e.proposed,"endDate",t)},expression:"proposed.endDate"}},i))]}}]),model:{value:e.modalEnd,callback:function(t){e.modalEnd=t},expression:"modalEnd"}},[e._v(" "),a("v-date-picker",{attrs:{min:e.endDateMin,scrollable:""},model:{value:e.proposed.endDate,callback:function(t){e.$set(e.proposed,"endDate",t)},expression:"proposed.endDate"}},[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(t){e.modalEnd=!1}}},[e._v("Cancel")]),e._v(" "),a("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(t){return e.$refs.dialogEnd.save(e.proposed.endDate)}}},[e._v("OK")])],1)],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm2:""}},[a("v-btn",{attrs:{block:"",color:"primary",disabled:!1},on:{click:function(t){return e.add()}}},[e._v("\n                                Add\n                                "),a("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)],1)],1)],1)])],1)]],2)};T._withStripped=!0;var H=a(174),L={props:{value:{type:Object,required:!0}},data(){return{description:{key:"description",type:"string",minimum:1,maximum:1,placeholder:"Away on holidays",title:"Description"},actionIndexes:{},loading:!0,modalStart:!1,modalEnd:!1,model:this.value,unavailabilities:[],proposed:{description:void 0,startDate:this.startDateMin,endDate:this.startDateMin}}},created(){console.log("RELOAD TEAMS"),this.reloadRelationships(),this.resetProposed()},methods:{add(){var e=this,t=JSON.parse(JSON.stringify(e.proposed));return t.startDate=new Date(t.startDate),t.startDate.setHours(0),t.startDate.setMinutes(0),t.startDate.setSeconds(0),t.endDate=new Date(t.endDate),t.endDate.setHours(23),t.endDate.setMinutes(59),t.endDate.setSeconds(59),e.$fluro.api.post(`/contact/${e.contactID}/unavailability`,t).then((function(t){e.$fluro.notify(`Successfully updated ${e.contextName} unavailability`,{type:"success"}),e.unavailabilities.push(t.data),e.resetProposed()})).catch((function(t){e.$fluro.error(t)}))},resetProposed(){this.proposed={description:void 0,startDate:this.startDateMin,endDate:this.startDateMin}},reloadRelationships(){var e=this;e.loading=!0,e.contactID?e.$fluro.api.get(`/contact/${e.contactID}/unavailability`,{}).then((function(t){e.unavailabilities=t.data,e.loading=!1})).catch((function(t){e.loading=!1})):e.loading=!1},remove(e){var t=this;return t.$fluro.api.delete(`/contact/${t.contactID}/unavailability/${t.unavailabilities[e]._id}`).then((function(a){t.$fluro.notify(`Successfully deleted ${t.contextName} unavailability '${t.unavailabilities[e].description}'`,{type:"success"}),t.unavailabilities.splice(e,1)})).catch((function(e){t.$fluro.error(e)}))}},components:{FluroContentFormField:A.default,FluroContentSelectButton:F.default,ListGroup:m.a,ListGroupItem:p.a,FluroConfirmButton:H.default},watch:{"proposed.startDate":function(){this.proposed.endDate<this.proposed.startDate&&(this.proposed.endDate=this.proposed.startDate)}},computed:{contextName(){var e=this.model.preferredName||this.model.firstName||"";return e&&e.length?_.endsWith(e,"s")?e+"'":e+"'s":""},contactID(){if(this.model._id)return this.$fluro.utils.getStringID(this.model)},contactTitle(){return _.get(this.model,"title")||""},startDateMin(){var e=new Date;function t(e){var t=e.toString();return 1==t.length?"0"+t:t}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())},endDateMin(){var e=new Date(_.get(this.proposed,"startDate"));function t(e){var t=e.toString();return 1==t.length?"0"+t:t}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}},filters:{capitalize:e=>_.startCase(e),readableDate(e){return this.$fluro.date.moment(e.startDate).format("dddd, MMMM Do YYYY")==this.$fluro.date.moment(e.endDate).format("dddd, MMMM Do YYYY")?this.$fluro.date.moment(e.startDate).format("dddd, MMMM Do YYYY"):this.$fluro.date.moment(e.startDate).format("dddd, MMMM Do YYYY")+" - "+this.$fluro.date.moment(e.endDate).format("dddd, MMMM Do YYYY")}}},G=Object(h.a)(L,T,[],!1,null,null,null);G.options.__file="src/components/content/edit/components/ContactUnavailabilityManager.vue";var Y=G.exports,j=(a(35),{mixins:[n.a,r.a],components:{ContactTimeline:d.a,ContactGroupManager:c.default,ContactProcessManager:D,ContactCapabilityManager:O,ContactRelationshipManager:R,ContactUnavailabilityManager:Y,FluroAvatarUpdate:l.a,FluroRealmSelect:s.default,FluroAcademicSelect:o.a},methods:{ping(e){var t=this;e.pinging=!0,t.$fluro.api.get("/push/ping/"+e._id,{cache:!1}).then((function(a){e.pinging=!1,t.$fluro.notify("Ping notification sent!")})).catch((function(a){e.pinging=!1,t.$fluro.error(a)}))},resetDevices(){var e=this;e.$fluro.api.get("/push/clear/"+e.itemID,{cache:!1}).then((function(t){e.$fluro.notify("Devices Reset!"),console.log("Reset")})).catch((function(t){e.$fluro.error(t)}))},toggleSubscription(e){switch(e){case"sms":this.unsubscribedSMS?this.subscribe("sms"):this.unsubscribe("sms");break;case"mailout":this.unsubscribedMailout?this.subscribe("mailout"):this.unsubscribe("mailout")}},subscribe(e){var t,a=this;switch(e){case"mailout":if(!a.emails||!a.emails.length)return void a.$fluro.error("No email addresses provided");t="/mailout/resubscribe";break;case"sms":if(!a.phoneNumbers||!a.phoneNumbers.length)return void a.$fluro.error("No phone numbers provided");t="/sms/resubscribe"}a.$fluro.api.post(t,{phoneNumbers:a.phoneNumbers,emails:a.emails}).then((function(){a.subscriptionCacheKey=Math.random()}))},unsubscribe(e){var t,a=this;switch(e){case"mailout":if(!a.emails||!a.emails.length)return void a.$fluro.error("No email addresses provided");t="/mailout/unsubscribe";break;case"sms":if(!a.phoneNumbers||!a.phoneNumbers.length)return void a.$fluro.error("No phone numbers provided");t="/sms/unsubscribe"}a.$fluro.api.post(t,{phoneNumbers:a.phoneNumbers,emails:a.emails}).then((function(){a.subscriptionCacheKey=Math.random()}))},updateAcademicCalendar(e){this.$set(this.model,"academicCalendar",e),this.update(this.model)},updateAcademicGrade(e){this.$set(this.model,"academicGrade",e),this.update(this.model)},updateFamily(){var e=_.chain(this.family).get("address").values().compact().value();e&&e.length?this.$set(this.model,"family",this.family):this.$delete(this.model,"family")},updateSheetRealms(e,t){e=this.$fluro.utils.arrayIDs(e);this.model.details[t]||this.$set(this.model.details,t,{}),this.$set(this.model.details[t],"realms",e)},updateSheet(e,t){this.model.details[t]||this.$set(this.model.details,t,{}),this.$set(this.model.details[t],"data",e)}},watch:{title(e){this.$set(this.model,"title",this.title),this.update(this.model)}},created(){var e=this;e.model.academicCalendar||e.$set(e.model,"academicCalendar",""),e.model.academicGrade||e.$set(e.model,"academicGrade",""),e.config&&e.config.details&&e.config.details.length&&(e.sheetDefinitions=_.reduce(e.config.details,(function(t,a){if(!a.fields||!a.fields.length)return t;var i=a.definitionName,o={_id:a._id,title:a.title,type:"group",key:i,fields:a.fields,asObject:!0,minimum:1,maximum:1,askCount:1},s=_.get(e.model,"details."+i),n=JSON.parse(JSON.stringify(s||{})),r={realms:[],data:{}};if(n&&n.items&&n.items.length){var l=n.items[0];l.data||(l.data={}),l.realms||(l.realms=[]),r=l}return e.$set(a,"dataModel",r),a.field=o,t.push(a),t}),[]),e.model.details||(e.model.details={}))},asyncComputed:{contactDefinitions:{default:[],get(){var e=this;return new Promise((function(t,a){e.$fluro.types.subTypes("contact").then((function(e){e=_.chain(e).filter((function(e){return"active"==e.status})).map((function(e,t){return{_id:e._id,name:e.title,value:e.definitionName}})).value();t(e)})).catch(a)}))}},devices:{default:[],get(){var e=this;return"edit"==e.context&&e.itemID?new Promise((function(t,a){e.$fluro.api.get(`/contact/${e.itemID}/devices`).then((function(e){t(_.map(e.data,(function(e){return e.pinging=!1,e})))})).catch((function(e){a(e)}))})):Promise.resolve([])}},smsUnsubscribes:{default:[],get(){var e=this;return"edit"==e.context&&e.itemID?new Promise((function(t,a){e.$fluro.api.get(`/contact/${e.itemID}/smsunsubscribes?${e.subscriptionCacheKey}`).then((function(e){t(e.data)})).catch((function(e){a(e)}))})):Promise.resolve([])}},mailoutUnsubscribes:{default:[],get(){var e=this;return"edit"==e.context&&e.itemID?new Promise((function(t,a){e.$fluro.api.get(`/contact/${e.itemID}/unsubscribes?${e.subscriptionCacheKey}`).then((function(e){t(e.data)})).catch((function(e){a(e)}))})):Promise.resolve([])}}},computed:{fieldsOutput(){var e=[];function t(t,a){a.key=t,e.push(a)}return t("firstName",{title:"First Name",minimum:1,maximum:1,type:"string",placeholder:"Eg. Jessica"}),t("preferredName",{title:"Preferred/Nick Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. 'Jess'"}),t("middleName",{title:"Middle Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. 'Heather'"}),t("ethnicName",{title:"Ethnic Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. '吳爾霏'"}),t("maidenName",{title:"Maiden Name",minimum:0,maximum:1,type:"string",enabled:!1,placeholder:"Eg. 'Johnson'"}),t("lastName",{title:"Last Name",minimum:1,maximum:1,type:"string",placeholder:"Eg. Michaels"}),t("dob",{title:"Date of Birth",minimum:0,maximum:1,type:"date",directive:"date-select"}),t("dobVerified",{title:"Birthday type",minimum:0,maximum:1,type:"boolean",directive:"select",defaultValues:[!1],options:[{name:"It's a Guess",value:!1},{name:"It's Correct",value:!0}]}),t("family",{title:"Household / Primary Residence",minimum:0,maximum:1,type:"reference",directive:"reference-select",params:{restrictType:"family",template:{_context:"contact",title:this.model.lastName||"",realms:this.model.realms}}}),t("householdRole",{title:"Household Role",minimum:0,maximum:1,type:"string",directive:"select",options:[{name:"None",value:""},{name:"Parent",value:"parent"},{name:"Child",value:"child"}],params:{restrictType:"family"}}),t("deceased",{title:"Mark as deceased",minimum:0,maximum:1,type:"boolean",directive:"checkbox"}),t("deceasedDate",{title:"Deceased Date",minimum:0,maximum:1,type:"date",directive:"date-select"}),_.map(this.$fluro.date.timezones(),(function(e){return{name:e,value:e}})).unshift({name:"Use Account Default",value:""}),t("gender",{title:"Gender",minimum:1,maximum:1,type:"string",directive:"select",placeholder:"",options:[{name:"Male",value:"male"},{name:"Female",value:"female"},{name:"Unknown",value:"unknown"}]}),t("maritalStatus",{title:"Marital Status",minimum:0,maximum:1,type:"string",directive:"select",placeholder:"",options:[{name:"None",value:""},{name:"Single",value:"single"},{name:"In a relationship",value:"relationship"},{name:"Married",value:"married"},{name:"Widowed",value:"widowed"},{name:"Seperated",value:"seperated"},{name:"Divorced",value:"divorced"}]}),t("emails",{title:"Email Address",minimum:0,maximum:0,type:"email",placeholder:""}),t("phoneNumbers",{title:"Phone Number",minimum:0,maximum:0,type:"string",placeholder:"+61 400 123 456"}),t("timezone",{title:"Primary Timezone",minimum:0,maximum:1,type:"string",directive:"timezone-select",description:"Set a local timezone for this contact"}),t("countryCode",{title:"Default Country Code",minimum:0,maximum:1,type:"string",directive:"countrycodeselect"}),t("nametagNotes",{title:"Checkin Nametag Notes",minimum:0,maximum:1,type:"string"}),t("capabilities",{title:"Capabilities",minimum:0,maximum:0,type:"reference",description:"Add capabilities for this contact",params:{restrictType:"capability"}}),e},formOptions:()=>({}),title(){return this.model?this.model.preferredName?`${this.model.preferredName} ${this.model.lastName||""}`:this.model.firstName?`${this.model.firstName} ${this.model.lastName||""}`:"":""},phoneNumbers(){return this.model.phoneNumbers},emails(){return this.model.emails},unsubscribedMailout(){return!!this.mailoutUnsubscribes.length},unsubscribedSMS(){return!!this.smsUnsubscribes.length},contextName(){var e=this.model.preferredName||this.model.firstName||"";return e&&e.length?_.endsWith(e,"s")?e+"'":e+"'s":""},definitionField(){return{title:"Contact Type / Definition",minimum:0,maximum:1,type:"string",directive:"select",key:"definition",options:this.contactDefinitions}},showOutline:()=>!1,showPreferredName(){return this.model.preferredName&&this.model.preferredName.length||this.show.preferredName},showEthnicName(){return this.model.ethnicName&&this.model.ethnicName.length||this.show.ethnicName},showMiddleName(){return this.model.middleName&&this.model.middleName.length||this.show.middleName},showMaidenName(){return this.model.maidenName&&this.model.maidenName.length||this.show.maidenName}},data:()=>({subscriptionCacheKey:0,sheetDefinitions:[],details:{},detailsModel:{},family:{},show:{preferredName:!1,middleName:!1,ethnicName:!1,maidenName:!1},familyFields:[{title:"Name of household",key:"title",minimum:0,maximum:1,expressions:{defaultValue:"data.lastName"}},{title:"Address",key:"address",minimum:1,maximum:1,askCount:1,type:"group",asObject:!0,fields:[{title:"Street Address Line 1",key:"addressLine1",minimum:0,maximum:1},{title:"Address Line 2",key:"addressLine2",minimum:0,maximum:1,expressions:{hide:"!data.addressLine1.length"},className:"xs12 sm6"},{type:"group",minimum:1,askCount:1,maximum:1,sameLine:1,fields:[{title:"Suburb",key:"suburb",minimum:0,maximum:1,className:"xs12 sm4"},{title:"State",key:"state",minimum:0,maximum:1,className:"xs12 sm4"},{title:"Postal Code",key:"postalCode",minimum:0,maximum:1,className:"xs12 sm4"}]}]}]})}),z=(a(673),Object(h.a)(j,i,[],!1,null,"416e27af",null));z.options.__file="src/components/content/edit/panels/contact.vue";t.default=z.exports},512:function(e,t,a){"use strict";var i=a(10);t.a={props:{config:{type:Object,required:!0},context:{type:String,default:"new"}},data:()=>({loading:!1}),mounted(){this.$set(this.model,"_type",this.config.type.definitionName)},extends:i.default,components:{FluroContentForm:i.default,FluroContentFormField:()=>Promise.resolve().then(a.bind(null,11)),FluroPrivacySelect:()=>a.e(54).then(a.bind(null,513))},computed:{type(){return this.config.type},typeName(){return this.type?this.type.definitionName:""},itemID(){return this.model._id},definition(){return this.config.definition},definedFields(){return this.definition&&this.definition.fields&&this.definition.fields.length?this.definition.fields:[]},readableContentType(){return this.$fluro.types.readable(this.config.definition?this.config.definition.definitionName:this.config.type.definitionName)},fullBody(){return this.definition&&this.definition.data&&this.definition.data.fullBody},hideBody(){return this.definition&&this.definition.data&&this.definition.data.hideBody},titleLabel:()=>"Title",bodyLabel:()=>"Body"},methods:{}}},555:function(e,t,a){var i=a(670);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a(3).default)("3b8c1ab4",i,!1,{})},556:function(e,t,a){var i=a(672);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a(3).default)("80334e48",i,!1,{})},557:function(e,t,a){var i=a(674);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a(3).default)("ba3e89d8",i,!1,{})},623:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loading?a("fluro-page-preloader",{attrs:{contain:""}}):e._l(e.teamGroups,(function(t){return a("v-input",{staticClass:"no-flex"},[a("v-label",[e._v(e._s(t.title))]),e._v(" "),a("list-group",[e._l(t.teams,(function(t){return[a("list-group-item",{attrs:{item:t,firstLine:e._f("comma")(t.positions)},scopedSlots:e._u([{key:"right",fn:function(){return[a("v-menu",{attrs:{left:!0,fixed:!0,transition:"slide-y-transition","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(i){var o=i.on;return[a("v-btn",e._g({staticClass:"ma-0",attrs:{icon:"",small:"",flat:""}},o),[e.actionIndexes[t._id]?a("fluro-icon",{attrs:{icon:"times"}}):a("fluro-icon",{attrs:{icon:"ellipsis-h"}})],1)]}}],null,!0),model:{value:e.actionIndexes[t._id],callback:function(a){e.$set(e.actionIndexes,t._id,a)},expression:"actionIndexes[team._id]"}},[e._v(" "),a("v-list",{attrs:{dense:""}},[a("v-list-tile",{on:{click:function(a){return e.$actions.open([t])}}},[a("v-list-tile-content",[e._v("Actions")])],1),e._v(" "),e.canLeave(t)?a("v-list-tile",{on:{click:function(a){return e.leave(t)}}},[a("v-list-tile-content",[e._v("Remove "+e._s(e.model.firstName)+" from group")])],1):e._e()],1)],1)]},proxy:!0}],null,!0)})]}))],2),e._v(" "),e.canAdd(t.key)?[a("v-btn",{staticClass:"ml-0",attrs:{small:"",color:"primary"},on:{click:function(a){return e.select(t.key)}}},[e._v("\n                    Add "+e._s(t.title)+"\n                    "),a("fluro-icon",{attrs:{right:"",icon:"plus"}})],1)]:e._e()],2)}))],2)};i._withStripped=!0;var o=a(46),s=a(47),n=a(26),r=a(48),l=a(7),d=a.n(l),c={props:{value:{type:Object,required:!0}},data(){return{actionIndexes:{},model:this.value,loading:!0,newGroups:[],teams:[]}},created(){console.log("RELOAD TEAMS"),this.reloadTeams()},methods:{canLeave(e){var t=e.definition;return this.$fluro.access.can("leave",t,"team")||this.$fluro.access.canEditItem(e)},canAdd(e){var t=this.$fluro.access.can("join",e,"team"),a=this.$fluro.access.can("edit",e,"team");return t||a},leave(e){var t=this,a=t.$fluro.utils.getStringID(e);t.loading=!0;t.$batch.run({operation:"remove from team",ids:[t.contactID],teams:[a]}).then((function(e){var i=_.findIndex(t.teams,{_id:a});t.teams.splice(i,1),t.loading=!1})).catch((function(e){console.log("TEAMS ERR",e),t.reloadTeams()}))},select(e){var t=this,a=new(d.a.extend(r.a))({propsData:{minimum:0,maximum:0}});t.$fluro.modal({component:n.a,options:{allDefinitions:!1,selector:a,type:e,minimum:0,maximum:0}}).then((function(e){if(e&&e.length){t.loading=!0;var a=t.$fluro.utils.arrayIDs(e);t.$batch.run({operation:"add to team",ids:[t.contactID],teams:a}).then((function(e){console.log("TEAMS ADDED",e),t.reloadTeams()})).catch((function(e){console.log("TEAMS ERR",e),t.reloadTeams()}))}}))},reloadTeams(){var e=this;e.loading=!0,e.$fluro.api.get(`/contact/${e.contactID}/teams`).then((function(t){e.teams=t.data,e.loading=!1})).catch((function(t){e.loading=!1}))}},components:{ListGroup:o.a,ListGroupItem:s.a,FluroContentSelectModal:n.a},computed:{contactID(){return this.$fluro.utils.getStringID(this.model)},teamGroups(){var e=this,t=_.reduce(e.teamDefinitions,(function(e,t){return e[t.definitionName]={title:t.plural,teams:[],key:t.definitionName},e}),{team:{title:"Groups and Teams",teams:[],key:"team"}});return _.chain(e.teams).reduce((function(t,a){var i=a.definition||"team",o=t[i];return o||(o=t[i]={title:e.$fluro.types.readable(i,!0),teams:[]}),o.teams.push(a),t}),t).values().orderBy((function(e){return e.teams.length})).reverse().value()}},asyncComputed:{teamDefinitions:{default:[],get(){return this.$fluro.types.subTypes("team")}}}},u=a(0),m=Object(u.a)(c,i,[],!1,null,null,null);m.options.__file="src/components/content/edit/components/ContactGroupManager.vue";t.default=m.exports},669:function(e,t,a){"use strict";var i=a(555);a.n(i).a},670:function(e,t,a){(e.exports=a(2)(!1)).push([e.i,".process-state-card .fluro-card{position:relative;overflow:hidden;box-shadow:0 2px 3px rgba(0,0,0,0.1)}.process-state-card .due-date{font-style:italic;float:right}.process-state-card .color-block{width:3px;top:0;left:0;bottom:0;position:absolute}.process-state-card .fluro-card-body{padding:10px}.process-state-card.archived .fluro-card{opacity:0.5;background:none}.process-state-card.complete .fluro-card{color:#004d00;background:#4dff4d;border-color:rgba(0,128,0,0.1)}.process-state-card.complete .fluro-card .color-block{background:linear-gradient(#89e10c, #16d3ad) !important}.process-state-card.pending .fluro-card{color:#ec7b1f;background:#fceadb;border-color:rgba(240,151,78,0.1)}.process-state-card.pending .fluro-card .color-block{background:linear-gradient(#f0974e, #f0974e) !important}.process-state-card.failed .fluro-card,.process-state-card.overdue .fluro-card{color:#c00;background:#ffd1d1;border-color:rgba(255,0,0,0.1)}.process-state-card.failed .fluro-card:before,.process-state-card.overdue .fluro-card:before{display:block;background:linear-gradient(#ff4d83, #ff003c);animation-name:pulse_opacity;animation-duration:3s;animation-iteration-count:infinite;animation-timing-function:linear}.process-state-card.failed .fluro-card .color-block,.process-state-card.overdue .fluro-card .color-block{background:linear-gradient(#ff4d83, #ff003c) !important}.process-dots{display:block;white-space:nowrap}.process-dots.process-dots-flex{display:flex}.process-dots .process-dot{color:rgba(0,0,0,0.3)}.process-dots .process-dot.failed{color:red}.process-dots .process-dot.pending{color:#f0974e}.process-dots .process-dot.complete{color:green}\n",""])},671:function(e,t,a){"use strict";var i=a(556);a.n(i).a},672:function(e,t,a){(e.exports=a(2)(!1)).push([e.i,".anniversary{font-weight:normal;opacity:0.5}.relation-faces{display:block}.relation-faces .relation-face{width:100px;padding:10px;background:#fff;border:1px solid rgba(0,0,0,0.1);border-radius:4px;margin:0 1% 1% 0;display:inline-block;text-align:center;font-size:14px;cursor:pointer;vertical-align:top}.relation-faces .relation-face:hover{background:#fafafa}.relation-faces .relation-face.archived{opacity:0.5;border:1px solid rgba(0,0,0,0.1);background:none}.relation-faces .relation-face .details{padding:5px 0;text-transform:capitalize;font-size:0.8em;opacity:0.8}\n",""])},673:function(e,t,a){"use strict";var i=a(557);a.n(i).a},674:function(e,t,a){(e.exports=a(2)(!1)).push([e.i,".hint[data-v-416e27af]{font-size:10px;opacity:0.5;color:inherit;display:block}.bordered[data-v-416e27af]{border:1px solid rgba(0,0,0,0.1);box-shadow:0 2px 4px rgba(0,0,0,0.1)}.bordered[data-v-416e27af] .tabset-menu{background:#eee}\n",""])}}]);