(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{471:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flex-column",[e.loading?[i("fluro-page-preloader",{attrs:{contain:""}})]:[i("tabset",{attrs:{justified:!0,vertical:!0}},[i("tab",{attrs:{heading:"Details"}},[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",{attrs:{fluid:"","grid-list-lg":""}},[i("constrain",{attrs:{sm:""}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm12:""}},[i("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.options,field:e.fieldHash.title},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),e.model._id?e._e():i("v-flex",{attrs:{xs12:"",sm12:""}},[i("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.options,field:e.fieldHash.items},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.options,field:e.fieldHash.emails},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm6:""}},[i("fluro-content-form-field",{attrs:{"form-fields":e.formFields,outline:e.showOutline,options:e.options,field:e.fieldHash.phoneNumbers},on:{input:e.update},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm12:""}},[i("fluro-panel",[i("fluro-panel-title",[e._v("\n                                               Home Address\n                                           ")]),e._v(" "),i("fluro-panel-body",[i("address-manager",{model:{value:e.model.address,callback:function(t){e.$set(e.model,"address",t)},expression:"model.address"}})],1)],1)],1),e._v(" "),i("v-flex",[i("fluro-panel",[i("fluro-panel-title",[i("div",{staticClass:"no-border-no-background",on:{click:function(t){return e.toggleSamePostal()}}},[i("fluro-toggle-item",{attrs:{inactive:!e.model.samePostal}},[e._v("Different Postal Address")])],1)]),e._v(" "),e.model.samePostal?i("fluro-panel-body",[i("address-manager",{model:{value:e.model.postalAddress,callback:function(t){e.$set(e.model,"postalAddress",t)},expression:"model.postalAddress"}})],1):e._e()],1)],1)],1)],1)],1)],1)],1),e._v(" "),e.model._id?i("tab",{attrs:{heading:e.membersLength+" Members"}},[i("flex-column-body",{staticStyle:{background:"#fafafa"}},[i("v-container",{attrs:{fluid:"","grid-list-lg":""}},[i("v-layout",{staticStyle:{"overflow-x":"scroll"},attrs:{row:"",wrap:"","justify-space-around":"","fill-height":""}},[e._l(e.members,(function(t,o){return i("div",{staticClass:"cards border"},[i("family-member-card",{attrs:{contactDefinitions:e.contactDefinitionOptions},model:{value:e.members[o],callback:function(t){e.$set(e.members,o,t)},expression:"members[index]"}})],1)})),e._v(" "),i("div",{staticClass:"ghost-card",on:{click:e.create}},[i("div",{staticClass:"add-contact ghost"},[i("div",{staticClass:"add-circle"},[i("fluro-icon",{staticClass:"add-icon",attrs:{icon:"plus"}})],1),e._v(" "),i("h5",{staticClass:"add-contact-text"},[e._v("Add Contact")])])])],2)],1)],1)],1):e._e(),e._v(" "),e.definition&&e.definition.fields&&e.definition.fields.length?i("tab",{attrs:{heading:e.definition.title+" Information"}},[i("fluro-content-form",{attrs:{options:e.options,fields:e.definition.fields},model:{value:e.model.data,callback:function(t){e.$set(e.model,"data",t)},expression:"model.data"}})],1):e._e()],1)]],2)};o._withStripped=!0;var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.model?i("v-container",{staticClass:"card",class:e.model.status,attrs:{fluid:"","grid-lines-sm":""}},[i("fluro-content-form",{attrs:{fields:e.fields},on:{input:e.save},scopedSlots:e._u([{key:"form",fn:function(t){var o=t.formFields,n=t.fieldHash,l=t.model,s=t.update,a=t.options;return[i("v-layout",{attrs:{column:""}},[i("v-flex",{staticClass:"avatar-flex"},[i("fluro-avatar",{staticClass:"avatar-icon",attrs:{id:l._id,type:"contact"}})],1),e._v(" "),i("v-flex",{staticClass:"text-centered less-padding"},[i("h4",[e._v(e._s(e.contactName))])]),e._v(" "),i("v-flex",{staticClass:"less-padding status-flex"},[i("fluro-status-select",{model:{value:l.status,callback:function(t){e.$set(l,"status",t)},expression:"model.status"}})],1),e._v(" "),i("v-flex",{staticClass:"text-centered less-padding"},[i("p",{staticClass:"muted",staticStyle:{"margin-bottom":"0px"}},[e._v(e._s(e.contactGender)+" "+e._s(e.contactAge))])]),e._v(" "),i("v-flex",{staticClass:"less-padding"},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.householdRole},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1),e._v(" "),i("v-flex",{staticClass:"less-padding"},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.definition},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1)],1),e._v(" "),i("v-layout",{attrs:{"align-center":""}},[i("v-flex",[i("v-btn",{attrs:{block:""},on:{click:function(t){return e.editContact()}}},[e._v("\n                        Edit\n                    ")])],1),e._v(" "),i("v-spacer"),e._v(" "),i("v-flex",[i("v-btn",{attrs:{block:""},on:{click:function(t){return e.viewContact()}}},[e._v("\n                        View\n                    ")])],1)],1)]}}],null,!1,1214556567),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1):e._e()};n._withStripped=!0;var l=i(10),s=i(11),a=i(52),r=i(36),d={props:{value:{type:Object,default:{}},contactDefinitions:{type:Array}},components:{FluroContentForm:l.default,FluroContentFormField:s.default,FluroStatusSelect:a.a,FluroAvatar:r.default},data(){return{model:this.value}},created(){this.model.definition||(this.model.definition=""),this.model.householdRole||(this.model.householdRole="")},watch:{contactStatus:function(){this.save()}},methods:{editContact(){var e=this;e.$fluro.global.edit(e.model,!0).then((function(t){_.assign(e.model,t),console.log("Update")}))},viewContact(){this.$fluro.global.view(this.model,!0)},save:_.debounce((function(){console.log("TRIGGER UPDATE");var e=this,t={householdRole:e.model.householdRole,definition:e.model.definition,status:e.model.status};e.$fluro.api.put("content/contact/"+e.model._id,t).then((function(t){e.$fluro.notify(e.model.title+" was successfully updated!")})).catch((function(t){e.$fluro.error(t)}))}),100)},computed:{contactName(){return this.model.title},contactAge(){return this.model.age},contactGender(){if(this.model.gender)return this.model.gender},contactStatus(){return this.model.status},fields(){var e=[];function t(t,i){i.key=t,e.push(i)}return t("householdRole",{title:"Family Role",minimum:0,maximum:1,type:"string",directive:"select",defaultValues:[""],options:[{name:"None / Other",value:""},{name:"Parent",value:"parent"},{name:"Guardian",value:"guardian"},{name:"Child",value:"child"}]}),t("definition",{title:"Definition",minimum:0,maximum:1,type:"string",directive:"select",defaultValues:[""],options:this.contactDefinitions}),e}}},m=(i(699),i(0)),u=Object(m.a)(d,n,[],!1,null,null,null);u.options.__file="src/components/content/edit/components/FamilyMemberCard.vue";var c=u.exports,f=i(512),p=i(619),h=i(180),v=(i(7),{components:{AddressManager:p.a,FamilyMemberCard:c},created(){},mixins:[f.a],computed:{members(){return _.orderBy(this.model.items,(function(e){return"parent"==e.householdRole?-1:e.age?120-parseInt(e.age):0}))},fieldsOutput(){var e=this,t=[];d("title",{title:"Title/Family Name",placeholder:"Family Name",minimum:1,maximum:1,type:"string"}),d("phoneNumbers",{title:"Household Phone Number",minimum:0,maximum:0,type:"string"}),d("emails",{title:"Household Email Address",minimum:0,maximum:0,type:"string"});var i=[],o={title:"Definition",key:"definitions",type:"group",sameLine:!0};o.fields=[{title:"Household Role",key:"householdRole",minimum:0,maximum:1,type:"string",directive:"select",options:[{title:"None",value:""},{title:"Parent",value:"parent"},{title:"Child",value:"child"}]},{title:"Definition",key:"definition",minimum:0,maximum:1,type:"string",directive:"select",options:e.contactDefinitionOptions,expressions:{hide:()=>!e.contactDefinitions||!e.contactDefinitions.length}}],i.push(o);var n={title:"Names",key:"names",type:"group",sameLine:!0};n.fields=[{title:"First Name",key:"firstName",minimum:1,maximum:1,type:"string"},{title:"Last Name",key:"lastName",placeholder:e.model.title,minimum:0,maximum:1,type:"string",expressions:{defaultValue:()=>e.model.title}}],i.push(n);var l={title:"Bits",key:"bits",type:"group",sameLine:!0,fields:[{title:"Gender",key:"gender",minimum:0,maximum:1,type:"string",directive:"select",options:[{title:"Male",value:"male"},{title:"Female",value:"female"},{title:"Unknown",value:""}]},{title:"Date of Birth",key:"dob",minimum:0,maximum:1,type:"date"}]};i.push(l);var s={title:"Comms",key:"comms",type:"group",sameLine:!0,fields:[{title:"Email Address",key:"emails",minimum:0,maximum:0,type:"email"},{title:"Phone Number",key:"phoneNumbers",minimum:0,maximum:0,type:"string"}]};i.push(s);var a={title:"Comms",key:"comms",type:"group",sameLine:!0,fields:[]};a.fields=[{title:"Realms",description:"If different from the family",key:"realms",minimum:0,maximum:0,type:"reference",directive:"realmselect",params:{restrictType:"realm"},expressions:{defaultValue:()=>e.model.realms.slice()}},{title:"Tags",key:"tags",minimum:0,maximum:0,type:"reference",directive:"content-select-button",params:{restrictType:"tag",allDefinitions:!0}}],i.push({title:"School / Academic Calendar",key:"_academic",minimum:0,maximum:1,type:"string",customComponent:h.a,expressions:{hide:"model.householdRole == 'parent'"}}),i.push(a);var r="contact"==e.model._context?0:1;function d(e,i){i.key=e,t.push(i)}return d("items",{title:"contact"==e.model._context?"Additional Family Member":"Family Member",minimum:r,maximum:0,type:"group",asObject:!0,askCount:r,fields:i,expressions:{hide:()=>"contact"==e.model._context}}),t},membersLength(){return _.get(this.model,"items")?this.model.items.length:0},contactDefinitionOptions(){var e=this.contactDefinitions;return e.unshift({name:"None",value:""}),e}},methods:{toggleSamePostal(){return this.model.samePostal?this.$set(this.model,"samePostal",!1):this.$set(this.model,"samePostal",!0)},create(){var e=this,t={family:e.model,lastName:e.model.title};console.log("Create new contact",t),e.$fluro.global.create("contact",{template:t},!0).then((function(t){e.model.items.push(t)}))}},data:()=>({}),asyncComputed:{contactDefinitions:{default:[],get(){var e=this;return new Promise((function(t,i){return e.$fluro.types.subTypes("contact").catch(i).then(t)})).catch((function(t){return console.log(t),e.$fluro.notify(t),reject(t)}))}}}}),x=(i(701),Object(m.a)(v,o,[],!1,null,null,null));x.options.__file="src/components/content/edit/panels/family.vue";t.default=x.exports},512:function(e,t,i){"use strict";var o=i(10);t.a={props:{config:{type:Object,required:!0},context:{type:String,default:"new"}},data:()=>({loading:!1}),mounted(){this.$set(this.model,"_type",this.config.type.definitionName)},extends:o.default,components:{FluroContentForm:o.default,FluroContentFormField:()=>Promise.resolve().then(i.bind(null,11)),FluroPrivacySelect:()=>i.e(54).then(i.bind(null,513))},computed:{type(){return this.config.type},typeName(){return this.type?this.type.definitionName:""},itemID(){return this.model._id},definition(){return this.config.definition},definedFields(){return this.definition&&this.definition.fields&&this.definition.fields.length?this.definition.fields:[]},readableContentType(){return this.$fluro.types.readable(this.config.definition?this.config.definition.definitionName:this.config.type.definitionName)},fullBody(){return this.definition&&this.definition.data&&this.definition.data.fullBody},hideBody(){return this.definition&&this.definition.data&&this.definition.data.hideBody},titleLabel:()=>"Title",bodyLabel:()=>"Body"},methods:{}}},576:function(e,t,i){var o=i(700);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,i(3).default)("0cdb43a3",o,!1,{})},577:function(e,t,i){var o=i(702);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,i(3).default)("4afa34fe",o,!1,{})},619:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.model?i("v-container",{attrs:{fluid:"","grid-list-lg":""}},[i("fluro-content-form",{attrs:{fields:e.fields},scopedSlots:e._u([{key:"form",fn:function(t){var o=t.formFields,n=t.fieldHash,l=t.model,s=t.update,a=t.options;return[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm12:""}},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.addressLine1},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm12:""}},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.addressLine2},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.suburb},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.state},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.postalCode},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1),e._v(" "),i("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[i("fluro-content-form-field",{attrs:{"form-fields":o,options:a,field:n.country},on:{input:s},model:{value:l,callback:function(e){l=e},expression:"model"}})],1)],1)]}}],null,!1,3582871058),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1):e._e()};o._withStripped=!0;var n=i(10),l=i(11),s={props:{value:{type:Object,default:function(){return{}}}},components:{FluroContentForm:n.default,FluroContentFormField:l.default},data(){return{model:this.value,proposed:{}}},methods:{},computed:{fields(){var e=[];function t(t,i){i.key=t,e.push(i)}return t("addressLine1",{title:"Address Line 1",minimum:0,maximum:1,type:"string"}),t("addressLine2",{title:"Address Line 2",minimum:0,maximum:1,type:"string"}),t("suburb",{title:"Suburb",minimum:0,maximum:1,type:"string"}),t("state",{title:"State",minimum:0,maximum:1,type:"string"}),t("postalCode",{title:"Postal Code",minimum:0,maximum:1,type:"string"}),t("country",{title:"Country",minimum:0,maximum:1,type:"string",directive:"countryselect"}),e}}},a=i(0),r=Object(a.a)(s,o,[],!1,null,null,null);r.options.__file="src/components/content/edit/components/AddressManager.vue";t.a=r.exports},699:function(e,t,i){"use strict";var o=i(576);i.n(o).a},700:function(e,t,i){(e.exports=i(2)(!1)).push([e.i,".card{width:100%;height:100%}.avatar-icon{width:80% !important;display:block}.avatar-flex{display:flex;width:100%;justify-content:center}.status-flex{display:flex;width:100%;justify-content:center}.text-centered{text-align:center}.less-padding{padding:4px 8px !important}.archived{opacity:0.5}.draft{border:dashed orange 1px}\n",""])},701:function(e,t,i){"use strict";var o=i(577);i.n(o).a},702:function(e,t,i){(e.exports=i(2)(!1)).push([e.i,".no-border-no-background .toggle-item{border:none !important;background:none !important;font-size:14px;padding:0px}.cards{width:200px !important;background-color:white;margin:10px}.border{border-color:rgba(0,0,0,0.05);border-style:solid;border-width:1px}.ghost-card{padding:16px;width:200px !important;margin:10px;border:1px dashed #ccc;color:inherit;background-color:transparent;transition:background-color 0.3s}.ghost-card:hover{background-color:white}.add-circle{border:1px dashed #ccc;border-radius:50%;height:132.8px;width:132.8px;padding:8px;margin:auto;display:flex;justify-content:center;align-items:center}.filler-ghost{height:100%;display:block}.add-icon{width:100%;height:100%}.add-contact-text{text-align:center;padding-top:16px}\n",""])}}]);